function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){r=!0,n=e},f:function(){try{o||null==a.return||a.return()}finally{if(r)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var a,i=_getPrototypeOf(e);if(t){var s=_getPrototypeOf(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach((function(t){_defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _defineProperty(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var Game=function(){function e(t){_classCallCheck(this,e),this.scene=t,game_data.game_root=this}return _createClass(e,[{key:"get_social_api",value:function(){return"your_net_id"==loading_vars.net_id?new YourNetApi:"y"==loading_vars.net_id?new Y:new DefaultApi}},{key:"prepare_game",value:function(){game_data.socialApi=this.get_social_api(),game_data.utils=new GameUtils,game_data.audio_manager=new AudioManager(game_data.scene),this.bg_holder=new Phaser.GameObjects.Container(game_data.scene,0,0),game_data.scene.add.existing(this.bg_holder);var e=new Phaser.GameObjects.Image(this.scene,0,0,"back");game_data.bg=e,e.setOrigin(0,0),this.bg_holder.add(e),this.create_main_game()}},{key:"update",value:function(e,t){"GAME_PLAY"===game_data.current_scene&&this.game_play&&this.game_play.update(e,t)}},{key:"create_main_game",value:function(){var e=this;game_data.rich_fx=!0;try{game.scene.renderer.supportedExtensions.length<20&&(game_data.rich_fx=!1)}catch(e){game_data.rich_fx=!1}game_data.utils.init(game_data.scene),game_data.utils.emitter.on("EVENT",this.handler_event,this),game_data.graphics_manager=new GraphicsManager,game_data.graphics_manager.init(game_data.scene),window.addEventListener("resize",(function(){game_data.socialApi.set_game_size()})),game_data.scene.game.events.addListener(Phaser.Core.Events.PAUSE,this.onPause,this),game_data.scene.game.events.addListener(Phaser.Core.Events.RESUME,this.onResume,this),game_data.audio_manager.init(),this.game_map=new GameMap(game_data.scene),this.game_play=new GamePlay(game_data.scene),this.game_windows=new GameWindows(game_data.scene),this.game_play.visible=!1,game_data.money_holder=new Phaser.GameObjects.Container(game_data.scene,0,0),game_data.options_holder=new Phaser.GameObjects.Container(game_data.scene,0,0),game_data.scene.add.existing(this.game_map),game_data.scene.add.existing(this.game_play),game_data.scene.add.existing(game_data.money_holder),game_data.scene.add.existing(game_data.options_holder),game_data.scene.add.existing(this.game_windows);var t=new Phaser.GameObjects.Container(game_data.scene,0,0);game_data.scene.add.existing(t),game_data.moving_holder=t,game_data.test_ad_manager=new TestAdManager(game_data.scene),game_data.scene.add.existing(game_data.test_ad_manager),this.wnd_overlay=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.wnd_overlay.setOrigin(0,0),this.wnd_overlay.alpha=.01,game_data.scene.add.existing(this.wnd_overlay),this.wnd_overlay.setInteractive(),this.wnd_overlay.visible=!1,game_data.utils.init_loading(),game_data.utils.add_loading(),game_data.utils.load_xmls_preloaded((function(){e.game_map.visible=!1,e.game_map.init({}),e.start_game(),e.game_map.visible=!0})),this.start_music()}},{key:"block_interface",value:function(){this.wnd_overlay&&(this.wnd_overlay.visible=!0)}},{key:"unblock_interface",value:function(){this.wnd_overlay&&(this.wnd_overlay.visible=!1)}},{key:"onFocus",value:function(e){}},{key:"onPause",value:function(e){pause()}},{key:"onResume",value:function(){resume()}},{key:"onHidden",value:function(e){}},{key:"onVisible",value:function(e){}},{key:"start_music",value:function(){game_data.audio_manager.sound_event({play:!0,loop:!0,sound_type:"music",sound_name:"free_main1",audio_kind:"music",map:!0})}},{key:"start_game",value:function(){var e=this;game_data.start_timestamp=game_data.utils.get_time(),game_data.utils.init_tips(),this.game_map.emitter.on("EVENT",this.handler_event,this),game_data.current_scene="MAP",this.game_map.setVisible(!0),this.game_play.setVisible(!1),setTimeout((function(){game_data.socialApi.set_game_size(),setTimeout((function(){game_data.scene.scale.refresh()}),1e3),e.show_map({init:!0})}),250),this.game_windows.init({}),this.game_windows.emitter.on("EVENT",this.handler_event,this),this.game_play.init(),this.game_play.emitter.on("EVENT",this.handler_event,this),setTimeout((function(){game_data.utils.remove_loading()}),2e3)}},{key:"handler_event",value:function(e){switch(e.event){case"show_scene":this.show_scene(e);break;case"start_level":this.start_level(e);break;case"show_window":this.show_window(e);break;case"window_closed":e.pending_length||game_data.utils.resume_tip();break;case"window_shown":default:break;case"update_money":this.game_map.update_money();break;case"update_language":this.game_play.update_language(),this.game_map.update_language(),game_data.utils.update_language();break;case"continue_game":this.game_play.continue_game();break;case"rewarded_ad_watched":this.game_play.rewarded_ad_watched();break;case"level_quit":this.game_play.level_quit();break;case"destroy_level":this.game_play.destroy_level()}}},{key:"show_window",value:function(e){"money_pt"in e||(e.money_pt=this.game_map.get_money_pt()),this.game_windows.show_window(e)}},{key:"show_scene",value:function(e){switch(game_data.utils.hide_tip(),game_data.current_scene=e.scene_id,e.scene_id){case"GAMEPLAY":this.show_gameplay(e);break;case"MAP":this.show_map(e)}}},{key:"show_gameplay",value:function(e){game_data.is_gameplay=!0,game_data.current_scene="GAMEPLAY"}},{key:"start_level",value:function(e){var t=this,a=e.level_id;game_data.utils.get_level(a,(function(a){"success"in a&&a.success&&(t.game_play.setVisible(!0),t.game_map.setVisible(!1),game_data.current_scene="GAMEPLAY",t.game_play.start_level(e))}))}},{key:"show_map",value:function(e){this.game_map.visible=!0,this.game_play.visible=!1,game_data.current_scene="MAP",this.game_map.show_map(e),game_data.is_gameplay=!1}}]),e}(),GameMap=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter,this.game_started=0,this.params={items_per_page:20}},init:function(e){game_data.game_map=this,this.create_assets()},reset_music:function(){game_data.audio_manager.sound_event({stop_all:!0}),game_data.audio_manager.sound_event({play:!0,loop:!0,sound_type:"music",sound_name:"music_map",audio_kind:"music",map:!0})},show_map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.first_complete||this.update_money(),e.init&&game_data.utils.check_ads("game_start")},handler_options:function(e){this.emitter.emit("EVENT",{event:"show_window",window_id:"options"})},get_money_pt:function(){return game_data.utils.toGlobal(game_data.game_map,new Phaser.Geom.Point(game_data.game_map.container_user_money.x,game_data.game_map.container_user_money.y))},update_language:function(){},create_assets:function(){var e=this;this.button_options=new CustomButton(this.scene,loading_vars.W-50,40,this.handler_options,"common1","btn_options","btn_options","btn_options",this,null,null,1),game_data.options_holder.add(this.button_options),this.container_user_money=new Phaser.GameObjects.Container(this.scene,120,50),game_data.money_holder.add(this.container_user_money),this.user_money=new CustomButton(this.scene,0,0,this.handler_buy_money,"common1","panel4","panel4","panel4",this),this.container_user_money.add(this.user_money),this.user_money_coin=new Phaser.GameObjects.Image(this.scene,-45,-2,"common1","money_ico"),this.container_user_money.add(this.user_money_coin),this.user_money_txt=new Phaser.GameObjects.Text(this.scene,30,-5,"",{fontFamily:"font2",fontSize:30,color:"#a86233",stroke:"#ffe1a1",strokeThickness:3}),this.user_money_txt.setOrigin(.5),this.container_user_money.add(this.user_money_txt),this.create_levels(),this.update_money();var t=this.params.items_per_page;this.current_page=Math.floor(game_data.user_data.levels_passed.length/t),this.current_page<0&&(this.current_page=0),this.current_page>this.total_pages-1&&(this.current_page=this.total_pages-1),this.btn_left=new CustomButton(this.scene,.1*loading_vars.W,.53*loading_vars.H,(function(){e.handler_left()}),"common1","btn_play1","btn_play1","btn_play1",this,null,null,.85),this.btn_left.scaleX=-1,this.add(this.btn_left),this.btn_right=new CustomButton(this.scene,.9*loading_vars.W,.53*loading_vars.H,(function(){e.handler_right()}),"common1","btn_play1","btn_play1","btn_play1",this,null,null,.85),this.add(this.btn_right),this.update_levels(),this.update_buttons()},update_buttons:function(){this.btn_left.setVisible(!0),this.btn_right.setVisible(!0),0===this.current_page&&this.btn_left.setVisible(!1),this.current_page===this.total_pages-1&&this.btn_right.setVisible(!1),this.pages.forEach((function(e){return e.setVisible(!1)})),this.pages[this.current_page].setVisible(!0);var e=game_data.utils.page_requered_stars(this.current_page)>0;this.pages[this.current_page].items_group.setAlpha(e?.5:1)},handler_right:function(){this.current_page++,this.current_page>this.total_pages-1&&(this.current_page=this.total_pages-1),this.update_buttons()},handler_left:function(){this.current_page--,this.current_page<0&&(this.current_page=0),this.update_buttons()},create_levels:function(){var e=this;this.level_items=[];var t=[{x:0,y:0},{x:140,y:0},{x:280,y:0},{x:420,y:0},{x:560,y:0},{x:0,y:140},{x:140,y:140},{x:280,y:140},{x:420,y:140},{x:560,y:140},{x:0,y:280},{x:140,y:280},{x:280,y:280},{x:420,y:280},{x:560,y:280},{x:0,y:420},{x:140,y:420},{x:280,y:420},{x:420,y:420},{x:560,y:420}],a=this.params.items_per_page,i=levels.length,s=Math.ceil(i/a);this.total_pages=s,this.pages=[];for(var n=1,o=0;o<s;o++){var r=new Phaser.GameObjects.Container(this.scene,loading_vars.W/2-280,180);this.add(r),r.items_group=this.scene.add.group(),this.pages.push(r);var _=a;(o+1)*a>i&&(_=i-o*a);for(var l=function(){var a=t[d],i=a.x,s=a.y,o=n,_=new CustomButton(e.scene,i,s,(function(){e.handler_play(o,_)}),"common1","btn_level","btn_level","btn_level",e,null,null,1);r.add(_),r.items_group.add(_),_.id=o;var l=new Phaser.GameObjects.Text(e.scene,0,-5,n,{fontFamily:"font2",fontSize:45,color:"#ffffff"});l.setOrigin(.5),_.add(l),n++;var h=new Phaser.GameObjects.Image(e.scene,0,-55,"common1","star_unactive");h.scale=.8,_.add(h),_.star=h,e.level_items.push(_)},d=0;d<_;d++)l()}},update_levels:function(){var e=game_data.user_data.levels_passed;this.level_items.forEach((function(t){var a;(a=t.id-1 in e&&1===e[t.id-1]?"star_active":"star_unactive")?(t.star.setTexture("common1",a),t.star.setVisible(!0)):t.star.setVisible(!1)}))},new_score:function(){},handler_buy_money:function(){if(game_data.allow_shop)this.emitter.emit("EVENT",{event:"show_window",window_id:"buy_money"});else{var e=game_data.utils.toGlobal(this.user_money,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:e,scene_id:"game_tip",item_id:"tip",phrase_id:"money",values:[]})}},update_money:function(){this.user_money_txt.setText(game_data.user_data.money)},handler_play:function(e,t){this.start_level(e,t)},update:function(){},start_level:function(e,t){var a=game_data.utils.get_passed_amount();if(loading_vars.demo_mode&&a>=3&&e>3){var i=game_data.utils.toGlobal(t,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:i,scene_id:"game_map",item_id:"demo",phrase_id:"1",values:[]})}else if(game_data.utils.is_level_available(e)||game_data.dev_mode)game_data.utils.check_ads("level_start"),this.emitter.emit("EVENT",{event:"start_level",level_id:e}),this.game_started++;else{var s=game_data.utils.toGlobal(t,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:s,scene_id:"game_map",item_id:"level_inavailable",phrase_id:"1",values:[]})}}}),GamePlay=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter,this.level_active=!1,this.level_fail=!1,this.allow_click=!0,this.currentStageAdsWatched=0,this.angles=[45,90,135,180,225,270,315],this.level_stage=0,this.circle_imgs=[],this.test_texts=[]},init:function(e){var t=this;game_data.game_play=this,this.game_engine=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.game_engine),this.piece_container=new Phaser.GameObjects.Container(this.scene,200,100).setScale(.7),this.game_engine.add(this.piece_container),this.reveal_back=new Phaser.GameObjects.Image(this.scene,200,100,"rope").setScale(.7).setOrigin(0).setVisible(!1),this.game_engine.add(this.reveal_back),game_data.rich_fx&&(this.reveal_back.fx=this.reveal_back.postFX.addReveal(.1,1,0)),this.frame_container=new Phaser.GameObjects.Container(this.scene,0,0),this.game_engine.add(this.frame_container);var a=new Phaser.GameObjects.Image(this.scene,1100,100,"rope").setOrigin(.5).setAngle(-90);this.frame_container.add(a);var i=new Phaser.GameObjects.Image(this.scene,175,100,"rope").setOrigin(.5).setAngle(-90);this.frame_container.add(i);var s=new Phaser.GameObjects.Image(this.scene,loading_vars.W/2,loading_vars.H/2-20,"frame").setOrigin(.5);if(this.frame_container.add(s),this.moving_holder=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.moving_holder),this.stage_panel=new StagePanel(game_data.scene),this.stage_panel.x=loading_vars.W/2,this.stage_panel.y=.93*loading_vars.H,this.stage_panel.init(),this.game_engine.add(this.stage_panel),this.stage_panel.emitter.on("EVENT",this.handler_event,this),this.timer_panel=new TimerPanel(game_data.scene),this.timer_panel.x=1230,this.timer_panel.y=400,this.timer_panel.init({moving_holder:this.moving_holder}),this.game_engine.add(this.timer_panel),this.timer_panel.emitter.on("EVENT",this.handler_event,this),game_data.dev_mode){this.test_win=new CustomButton(this.scene,50,680,(function(){t.allow_click&&t.check_win(!0)}),"common1","btn_level","btn_level","btn_level",this,null,null,1),this.add(this.test_win);var n=new Phaser.GameObjects.Text(this.scene,0,0,"Win",_objectSpread(_objectSpread({},game_data.styles.panel_text),{},{fontFamily:"font1",fontSize:40,align:"center"}));n.setOrigin(.5),this.test_win.add(n)}this.hint_panel=new HintPanel(game_data.scene),this.hint_panel.x=.96*loading_vars.W,this.hint_panel.y=.93*loading_vars.H,this.hint_panel.init({moving_holder:this.moving_holder}),this.game_engine.add(this.hint_panel),this.hint_panel.emitter.on("EVENT",this.handler_event,this),this.info_btn=new CustomButton(this.scene,.905*loading_vars.W,45,(function(){t.handler_info()}),"common1","btn_que","btn_que","btn_que",this,null,null,1),this.add(this.info_btn),this.wnd_overlay=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.wnd_overlay.setOrigin(0,0),this.wnd_overlay.alpha=.01,game_data.scene.add.existing(this.wnd_overlay),this.wnd_overlay.setInteractive(),this.wnd_overlay.visible=!1,this.bringToTop(this.moving_holder)},handler_info:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.emitter.emit("EVENT",{event:"show_window",window_id:"info",close_callback:e})},block_interface:function(){this.wnd_overlay&&(this.wnd_overlay.visible=!0)},unblock_interface:function(){this.wnd_overlay&&(this.wnd_overlay.visible=!1)},is_paused:function(){return this.timer_panel.is_paused()},pause_timer:function(){this.timer_panel.pause_timer(),this.level_active&&this.timer_panel.pause_timer()},resume_timer:function(){this.level_active&&this.timer_panel.resume_timer()},level_failed:function(){this.level_fail=!0,this.emitter.emit("EVENT",{event:"show_window",window_id:"level_failed",currentStageAdsWatched:this.currentStageAdsWatched})},level_quit:function(){var e=this;game_request.request({level_failed:!0},(function(t){e.destroy_level(),game_data.utils.check_ads("level_lost"),e.emitter.emit("EVENT",{event:"show_scene",scene_id:"MAP",failed:!0}),game_data.utils.game_play_stop()}))},continue_game:function(){this.level_fail=!1,this.tictac_played=!1,this.allow_click=!0,this.timer_panel.continue_game(),this.restart_timer(),this.check_win()},update:function(e,t){this.level_active&&paused},show_overlay:function(){this.default_overlay.visible=!0},hide_overlay:function(){this.default_overlay.visible=!1},start_level:function(e){var t=this;this.level_id=e.level_id,game_data.utils.game_play_start(),game_data.current_scene="GAME_PLAY",this.level_active=!0,game_data.new_user&&1===this.level_id?this.handler_info((function(){t.update_manager({to_increment_stage:!1})})):this.update_manager({to_increment_stage:!1})},start_game_play:function(){this.restart_timer()},restart_timer:function(){this.timer_panel.restart_timer(),0===game_data.unpaused&&this.pause_timer()},update_manager:function(e){this.level_stage=0,this.blocks=[],this.blocksState={count:0},this.level_data=levels[this.level_id-1],"time"in this.level_data||(this.level_data.time=game_data.default_time),this.stage_panel.start_level(this.level_data),this.timer_panel.start_level(this.level_data),this.startPuzzle(this.level_data,!0)},startPuzzle:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.pictures,s=e.points,n=i[this.level_stage];n="level".concat(this.level_id,"_").concat(n),this.allow_click=!1,this.back?(this.reveal_back.setVisible(!0).setTexture(this.back.frame.texture.key),game_data.rich_fx?(this.reveal_back.fx.progress=1,game_data.scene.tweens.add({targets:this.reveal_back.fx,progress:0,repeatDelay:1e3,hold:1e3,duration:2e3,ease:"Sine.easeInOut",onComplete:function(){t.reveal_back.setVisible(!1)}})):(this.reveal_back.alpha=1,game_data.scene.tweens.add({targets:[this.reveal_back],ease:"Sine.easeInOut",duration:1e3,alpha:0,onComplete:function(){t.reveal_back.setVisible(!1)}})),this.back.setTexture(n)):(this.back=new Phaser.GameObjects.Image(this.scene,0,0,n).setOrigin(0),this.piece_container.add(this.back),this.back.setInteractive(),game_data.dev_mode&&this.back.on("pointerdown",(function(e,t,a){}))),this.test_texts.forEach((function(e){e.destroy()})),this.test_texts=[],this.circle_imgs.forEach((function(e){e.circle.destroy(),e.destroy()})),this.circle_imgs=[],this.txts=this.scene.add.group(),setTimeout((function(){game_data.audio_manager.sound_event({play:!0,sound_name:"spin"})}),1e3),s[this.level_stage].forEach((function(e,i){var s=e.x,o=e.y,r=e.radius,_=new Phaser.GameObjects.Image(t.scene,0,0,n).setOrigin(0);t.circle_imgs.push(_),t.piece_container.add(_);var l=0+s/_.width,d=0+o/_.height;_.setOrigin(l,d),_.setPosition(_.width*l,_.height*d);var h=Phaser.Utils.Array.GetRandom(t.angles);t.scene.tweens.add({targets:[_],ease:"Back.easeInOut",duration:2e3,delay:1500,angle:Phaser.Utils.Array.GetRandom([360,720,1080,1440,1800])+h,onComplete:function(){u.allow_click=!0,t.allow_click=!0,a&&0===i&&t.start_game_play()}});var c=game_data.utils.toGlobal(t.piece_container,new Phaser.Geom.Point(s,o)),u=t.scene.add.graphics({fillStyle:{color:0,alpha:0}}).setPosition(c.x,c.y).fillCircle(0,0,r),m=new Phaser.Geom.Circle(0,0,r);u.setInteractive({hitArea:m,hitAreaCallback:Phaser.Geom.Circle.Contains,useHandCursor:!0}),u.on("pointerdown",(function(){t.timer_panel.get_current_perc()*(1e3*t.level_data.time)>350&&u.allow_click&&t.allow_click&&(game_data.audio_manager.sound_event({play:!0,sound_name:"piece_switch"}),u.allow_click=!1,t.scene.tweens.add({targets:[_],ease:"Back.easeOut",duration:350,angle:"+=45",onComplete:function(){u.allow_click=!0,t.check_win()}}))}),t),_.circle=u,_.setMask(u.createGeometryMask());var g=new Phaser.GameObjects.Text(t.scene,_.x,_.y,"x:".concat(s,",\ny:").concat(o,",\nradius:").concat(r),_objectSpread(_objectSpread({},game_data.styles.panel_text),{},{fontFamily:"font1",fontSize:20,align:"center"}));g.setOrigin(.5),t.piece_container.add(g),t.test_texts.push(g),game_data.dev_mode||g.setVisible(!1),t.txts.add(g)}))},check_win:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(this.circle_imgs.every((function(e){return 0===e.angle}))||e)&&(this.allow_click=!1,this.level_stage+1 in this.level_data.pictures?(this.test_texts.forEach((function(e){e.destroy()})),this.circle_imgs.forEach((function(e){e.circle.destroy(),e.destroy()})),this.level_stage++,this.stage_panel.update_panel(this.level_stage),this.startPuzzle(this.level_data),game_data.audio_manager.sound_event({play:!0,sound_name:"stage_complete"})):(this.level_stage++,this.stage_panel.update_panel(this.level_stage),this.level_complete()))},handler_event:function(e){switch(e.event){case"level_failed":this.level_failed();break;case"check_win":this.check_win();break;case"pause_timer":this.pause_timer();break;case"resume_timer":this.resume_timer();break;default:this.emitter.emit("EVENT",e)}},level_complete:function(){var e=this;clearTimeout(this.clear_tid),this.remove_countdown_tween(),this.timer_panel.level_complete(),game_data.audio_manager.sound_event({play:!0,sound_name:"level_complete"}),this.tictac_played=!1,game_data.utils.check_ads("level_win"),this.confetti_anim(),this.scene.time.addEvent({delay:1500,callbackScope:this,callback:function(){this.stop_confetti()}}),game_request.request({level_complete:!0,level_id:this.level_id,star_collected:!0},(function(t){t&&t.success&&(game_data.game_map.update_levels({passed_id:e.level_id}),t.happy_moment&&game_data.utils.happy_moment(),e.emitter.emit("EVENT",{event:"show_window",window_id:"level_complete",level_id:e.level_id,first_complete:t.first_complete}))}))},confetti_anim:function(){this.confetti_time=game_request.get_time();var e=new Phaser.Geom.Rectangle(0,-50,loading_vars.W,-20),t=this.scene.add.particles(0,0,"common1",{frame:{frames:["con1","con2","con3","con4","con5","con6"]},alpha:{start:1,end:.7},scaleX:{start:1.2,end:-1},scaleY:{start:1,end:.8},speed:{min:-100,max:100},lifespan:3500,gravityY:250,rotate:{onEmit:function(){return 360*Math.random()}},onUpdate:function(e){return e.angle+1},blendMode:"NORMAL",emitZone:{type:"random",source:e}});game_data.moving_holder.add(t),this.confetti_emitter=t},stop_confetti:function(){var e=this,t=game_request.get_time(),a=10;t-this.confetti_time<2e3&&(a=t-this.confetti_time),a<0&&(a=10),setTimeout((function(){e.confetti_emitter&&(e.confetti_emitter.stop(),setTimeout((function(){e.confetti_emitter&&e.confetti_emitter.destroy()}),2800))}),a)},rewarded_ad_watched:function(){this.currentStageAdsWatched++},destroy_level:function(){this.back.destroy(),this.back=null,this.level_active=!1,this.level_fail=!1,this.tictac_played=!1,this.currentStageAdsWatched=0,this.timer_panel.destroy_level(),this.remove_countdown_tween(),this.stage_panel.destroy_level(),this.circle_imgs.forEach((function(e){e.circle.destroy(),e.destroy()}))},remove_countdown_tween:function(){this.timer_panel.remove_countdown_tween()},update_language:function(){}}),HintPanel=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){var t=this;this.moving_holder=e.moving_holder,this.btn_hint=new CustomButton(this.scene,0,0,(function(){game_data.game_play.allow_click&&t.handler_hint()}),"common1","btn_level","btn_level","btn_level",this,null,null,1),this.add(this.btn_hint);var a=new Phaser.GameObjects.Image(this.scene,0,0,"common1","hint").setScale(.65);this.btn_hint.add(a),this.price_cont=new Phaser.GameObjects.Container(this.scene,-40,20),this.add(this.price_cont),a=new Phaser.GameObjects.Image(this.scene,0,0,"common1","money_ico").setScale(.9),this.price_cont.add(a),this.hint_price=new Phaser.GameObjects.Text(this.scene,-3,-3,game_data.boosters.hint,{fontFamily:"font2",fontSize:30,color:"#a86233",stroke:"#ffe1a1",strokeThickness:3}),this.hint_price.setOrigin(.5),this.price_cont.add(this.hint_price)},start_level:function(e){},handler_hint:function(){var e=this;if(game_data.user_data.money>=game_data.boosters.hint){var t=game_data.game_play.circle_imgs.filter((function(e){return 0!==e.angle})).filter((function(e){return e.circle.allow_click}));t.length&&game_request.request({buy_booster:!0,booster_id:"hint"},(function(a){if(a.success){game_data.audio_manager.sound_event({play:!0,sound_name:"hint"}),e.emitter.emit("EVENT",{event:"update_money"});var i=Phaser.Utils.Array.GetRandom(t);i.circle.allow_click=!1,e.emitter.emit("EVENT",{event:"pause_timer"});var s=new Phaser.Geom.Point(e.btn_hint.x,e.btn_hint.y);s=game_data.utils.toGlobal(e.btn_hint.parentContainer,s);var n=game_data.utils.toGlobal(i.parentContainer,new Phaser.Geom.Point(i.x,i.y)),o=new Phaser.Geom.Point((2*s.x+n.x)/3,s.y-200),r=new Phaser.Geom.Point((s.x+2*n.x)/3,n.y+200);e.create_emitter_hint(s,o,r,n,(function(){e.scene.tweens.add({targets:[i],ease:"Back.easeOut",duration:350,angle:0,onComplete:function(){i.circle.allow_click=!0,e.emitter.emit("EVENT",{event:"check_win"}),e.emitter.emit("EVENT",{event:"resume_timer"})}})}))}else if(game_data.allow_shop)e.emitter.emit("EVENT",{event:"show_window",window_id:"buy_money"});else{var _=game_data.utils.toGlobal(game_data.game_map.user_money,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:_,scene_id:"game_tip",item_id:"shop",phrase_id:"1",values:[]})}}))}else if(game_data.allow_shop)this.emitter.emit("EVENT",{event:"show_window",window_id:"buy_money"});else{var a=game_data.utils.toGlobal(game_data.game_map.user_money,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:a,scene_id:"game_tip",item_id:"shop",phrase_id:"1",values:[]})}},create_emitter_hint:function(e,t,a,i){var s=this,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o="particle16";var r=new Phaser.Curves.CubicBezier(e,t,a,i);o=Math.random()<.5?"particle15":"particle16";var _,l=game_data.scene.add.particles(0,0,"common1",{frame:o,scale:{start:1.5,end:.3},speed:{min:-15,max:15},frequency:25,maxParticles:20,blendMode:"ADD",emitZone:{type:"edge",source:r,quantity:20,yoyo:!1}});this.moving_holder.add(l),setTimeout((function(){o=Math.random()<.5?"particle15":"particle16",_=game_data.scene.add.particles(0,0,"common1",{frame:o,scale:{start:1.5,end:.3},speed:{min:-15,max:15},frequency:25,maxParticles:18,blendMode:"ADD",emitZone:{type:"edge",source:r,quantity:18,yoyo:!1}}),s.moving_holder.add(_)}),20),setTimeout((function(){n()}),450)},destroy_level:function(){}}),StagePanel=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){this.stage_shine=new Phaser.GameObjects.Image(this.scene,0,0,"common1","luchi"),this.add(this.stage_shine),this.stage_shine.visible=!1},start_level:function(e){var t=e.pictures;this.panels=[];for(var a=-90,i=0;i<t.length;i++){var s=new Phaser.GameObjects.Image(this.scene,a,0,"common1","panel_2");this.panels.push(s),this.add(s);var n=new Phaser.GameObjects.Text(this.scene,a-1,0,i+1,_objectSpread(_objectSpread({},game_data.styles.panel_text),{},{fontFamily:"font1",fontSize:50,align:"center"}));n.setOrigin(.5),this.add(n),s.no=n,a+=90}a-=90,this.x=loading_vars.W/2-a/2+45,this.update_panel()},update_panel:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=0;a<this.panels.length;a++){var i=this.panels[a];a<t?(i.setFrame("panel_3"),i.no.text=""):a===t&&(i.setFrame("panel_1"),0!==a&&(this.stage_shine.scale=.1,this.stage_shine.visible=!0,this.stage_shine.x=i.x,this.stage_shine.y=i.y,game_data.scene.tweens.add({targets:this.stage_shine,scale:2,yoyo:!0,duration:600}),game_data.scene.tweens.add({targets:this.stage_shine,angle:360,duration:1e3,onComplete:function(){e.stage_shine.angle=0,e.stage_shine.visible=!1}})))}},destroy_level:function(){this.panels.forEach((function(e){return e.destroy()}))}}),TimerPanel=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){this.time_obj={},this.attr={},this.moving_holder=e.moving_holder,this.progress_bar=new Phaser.GameObjects.Container(this.scene,0,0),this.progress_bar.angle=-90,this.progress_bar_top=new Phaser.GameObjects.Image(this.scene,0,0,"common1","video_reward_progressbar1"),this.progress_bar_bg=new Phaser.GameObjects.Image(this.scene,0,0,"common1","video_reward_progressbar2"),this.progress_bar_line=new Phaser.GameObjects.Image(this.scene,4-this.progress_bar_top.width/2,-1.4,"common1","video_reward_progressbar3"),this.progress_bar_line.setOrigin(0,.5),this.progress_bar_line2=new Phaser.GameObjects.Image(this.scene,4-this.progress_bar_top.width/2,-1.4,"common1","video_reward_progressbar3"),this.progress_bar_line2.setOrigin(0,.5),this.progress_bar_line2.setTintFill(13775667),this.progress_bar_line2.setVisible(!1),this.progress_bar.max_scale=(this.progress_bar_bg.width-8)/this.progress_bar_line.width,this.progress_bar_line.scaleX=this.progress_bar.max_scale,this.progress_bar_line.scaleY=1.2,this.progress_bar_line2.scaleX=this.progress_bar.max_scale,this.progress_bar_line2.scaleY=1.2,this.progress_bar.add(this.progress_bar_bg),this.progress_bar.add(this.progress_bar_line),this.progress_bar.add(this.progress_bar_line2),this.progress_bar.add(this.progress_bar_top),this.add(this.progress_bar),game_data.scene.tweens.add({targets:this.progress_bar_line2,alpha:0,yoyo:!0,repeat:-1,duration:450,ease:"Sine.easeInOut"})},start_level:function(e){this.level_data=e},continue_game:function(){this.progress_bar_line2.setVisible(!1),game_data.scene.tweens.add({targets:this.progress_bar_line,scaleX:this.progress_bar.max_scale,duration:450,ease:"Sine.easeInOut"}),game_data.scene.tweens.add({targets:this.progress_bar_line2,scaleX:this.progress_bar.max_scale,duration:450,ease:"Sine.easeInOut"})},restart_timer:function(){var e=this;this.time_obj={val:this.progress_bar.max_scale},this.countdown_tween=game_data.scene.tweens.add({targets:this.time_obj,val:0,duration:1e3*this.level_data.time,onComplete:function(){e.allow_click=!1,e.emitter.emit("EVENT",{event:"level_failed"}),e.progress_bar_line2.setVisible(!1)},onUpdate:function(){e.progress_bar_line.scaleX=e.time_obj.val,e.progress_bar_line2.scaleX=e.time_obj.val,e.time_obj.val/e.progress_bar.max_scale<=.15&&!e.tictac_played&&(game_data.audio_manager.sound_event({play:!0,sound_name:"tic-tac"}),e.tictac_played=!0,e.progress_bar_line2.setVisible(!0))}})},level_complete:function(){game_data.scene.tweens.add({targets:this.progress_bar_line,scaleX:this.progress_bar.max_scale,duration:450,ease:"Sine.easeInOut"}),game_data.scene.tweens.add({targets:this.progress_bar_line2,scaleX:this.progress_bar.max_scale,duration:450,ease:"Sine.easeInOut"}),this.progress_bar_line2.setVisible(!1)},remove_countdown_tween:function(){try{this.countdown_tween&&(this.countdown_tween.pause(),this.countdown_tween.remove())}catch(e){}},pause_timer:function(){try{this.countdown_tween&&this.countdown_tween.pause()}catch(e){}},resume_timer:function(){try{this.attr.paused=!1,this.countdown_tween&&this.countdown_tween.resume()}catch(e){}},get_current_perc:function(){return this.time_obj.val/this.progress_bar.max_scale},is_paused:function(){return this.attr&&this.attr.paused},destroy_level:function(){this.progress_bar_line.scaleX=this.progress_bar.max_scale,this.progress_bar_line2.scaleX=this.progress_bar.max_scale,this.progress_bar_line2.setVisible(!1)}}),AudioManager=function(){function e(t){_classCallCheck(this,e),this.scene=game_data.scene}return _createClass(e,[{key:"init",value:function(){this.audio_library={},this.playing_sounds=[],this.sound_id=0,this.unpaused=1,this.play_first_map=!0}},{key:"sound_event",value:function(e){"preload_sounds"in e&&this.preload_sounds(),"preload_sound"in e&&this.preload_sound(e),"play"in e&&this.play_sound(e),"stop"in e&&this.stop_sound_type(e),"stop_all"in e&&this.stop_audio()}},{key:"preload_sounds",value:function(){var e=this,t=0,a=new Phaser.Loader.LoaderPlugin(this.scene),i=[],s=game_data.urls.audio;for(t=0;t<game_data.preload_sounds.length;t++){var n=game_data.preload_sounds[t];n in this.audio_library||!is_localhost&&!navigator.onLine||(i.push(n),a.audio(n,s+n+".mp3"))}a.once("complete",(function(){for(t=0;t<i.length;t++){var s=i[t];if(e.scene.cache.audio.exists(s)){var n=e.scene.sound.add(s);e.audio_library[s]={},e.audio_library[s].sound=n}}a.destroy()}),this),a.start()}},{key:"preload_sound",value:function(e){var t=this,a=e.sound_name;if(!(a in this.audio_library)&&(is_localhost||navigator.onLine)){var i=game_data.urls.audio,s=new Phaser.Loader.LoaderPlugin(this.scene);s.audio(a,i+a+".mp3"),s.once("complete",(function(){if(t.scene.cache.audio.exists(a)){var e=t.scene.sound.add(a);t.audio_library[a]={},t.audio_library[a].sound=e}s.destroy()})),s.start()}}},{key:"play_sound",value:function(e){var t,a=this,i=e.sound_name,s="audio_kind"in e?e.audio_kind:"sound";e.audio_kind=s;var n={volume:game_data.user_data[s]*this.unpaused};if(i in this.audio_library&&"sound"in this.audio_library[i]||this.scene.cache.audio.exists(i))(t=i in this.audio_library&&"sound"in this.audio_library[i]?this.audio_library[i].sound:this.scene.sound.add(i))&&("loop"in e?this.play_with_fade(e,t):t.play(n),this.add_playing_sound(e,t));else if(!(i in this.audio_library)&&(is_localhost||navigator.onLine)){"loop"in e&&this.play_first_map&&!("map"in e)&&(this.play_first_map=!1);var o=game_data.urls.audio,r=new Phaser.Loader.LoaderPlugin(this.scene);r.audio(i,o+i+".mp3"),r.once("complete",(function(){a.scene.cache.audio.exists(i)&&(t=a.scene.sound.add(i))&&(a.audio_library[i]={},a.audio_library[i].sound=t,"loop"in e?!a.play_first_map&&"map"in e||a.play_with_fade(e,t):t.play(n),a.add_playing_sound(e,t)),r.destroy()})),r.start()}}},{key:"update_volume",value:function(){var e,t;"unpaused"in game_data&&(this.unpaused=game_data.unpaused);for(var a=0;a<this.playing_sounds.length;a++)t="audio_kind"in(e=this.playing_sounds[a])?e.audio_kind:"sound",e.sound.isPlaying&&e.sound.setVolume(game_data.user_data[t]*this.unpaused)}},{key:"play_with_fade",value:function(e,t){var a=this,i=0;if(e.audio_kind in game_data.user_data&&(i=game_data.user_data[e.audio_kind]*this.unpaused),"music"==e.audio_kind){t.play({volume:0,loop:!0});var s=0;this.delay&&(s=this.delay),game_data.scene.tweens.add({targets:{val:0},val:i,delay:s,duration:1e3,ease:"Linear",callbackScope:this,onUpdate:function(e,i){t.isPlaying&&t.setVolume(i.val*a.unpaused)},onComplete:function(){t.isPlaying&&t.setVolume(game_data.user_data[e.audio_kind]*a.unpaused)}}),this.delay=1e3}else t.play({volume:i,loop:!0})}},{key:"stop_with_fade",value:function(e){var t=this,a=e.sound,i=0;if(e.audio_kind in game_data.user_data&&(i=game_data.user_data[e.audio_kind]*this.unpaused),"music"==e.audio_kind){var s={val:i};game_data.scene.tweens.add({targets:s,val:0,duration:1e3,ease:"Linear",callbackScope:this,onUpdate:function(e,i){a.isPlaying&&a.setVolume(i.val*t.unpaused)},onComplete:function(){a.stop()}})}else"ambience"==e.audio_type?(a.off("stop"),a.stop(),game_data.preload_sounds.indexOf(e.sound_name)<0&&(delete this.audio_library[e.sound_name],setTimeout((function(){a&&a.destroy(),t.scene.cache.audio.exists(e.sound_name)&&t.scene.cache.audio.remove(e.sound_name)}),10))):a.stop()}},{key:"add_playing_sound",value:function(e,t){var a=this;this.sound_id++;var i=this.sound_id,s="sound_type"in e?e.sound_type:"default",n="audio_kind"in e?e.audio_kind:"sound",o="audio_type"in e?e.audio_type:"sound";this.playing_sounds.push({sound_type:s,audio_kind:n,audio_type:o,sound:t,sound_id:i,sound_name:e.sound_name,loop:"loop"in e}),"sound"!=n||"loop"in e||"ambience"==o||t.once("stop",(function(){for(var e=0;e<a.playing_sounds.length;e++)if(a.playing_sounds[e].sound_id==i){a.playing_sounds[e];a.playing_sounds.splice(e,1);break}})),"ambience"==o&&t.once("stop",(function(){for(var t=0;t<a.playing_sounds.length;t++)if(a.playing_sounds[t].sound_id==i){var s=a.playing_sounds[t],n=game_data.user_data[e.audio_kind]*a.unpaused;s.sound.play({volume:n});break}}))}},{key:"stop_sound_type",value:function(e){var t,a,i="sound_type"in e?e.sound_type:"default",s="timeout"in e&&e.timeout>0?e.timeout:-1;for(t=0;t<this.playing_sounds.length;t++)(a=this.playing_sounds[t]).sound_type==i&&this.stop_sound(a,s)}},{key:"stop_sound",value:function(e,t){var a,i=e.sound_id;for(t>0||this.stop_with_fade(e),a=0;a<this.playing_sounds.length;a++)if(this.playing_sounds[a].sound_id==i){this.playing_sounds[a];this.playing_sounds.splice(a,1);break}}},{key:"try_destroy_sound",value:function(e){if(e.sound_name in this.audio_library)this.stop_with_fade(e),e=null;else if(e.sound){e.sound_name;e.sound=null,e=null,null}}},{key:"stop_audio",value:function(){for(var e;this.playing_sounds.length;)(e=this.playing_sounds.pop()).sound.off("stop"),this.try_destroy_sound(e)}},{key:"init_loading",value:function(e){}}]),e}(),CustomButton=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e,t,a,i,s,n,o,r,_){var l=this,d=arguments,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter,this.click=i,this.handler_over=h,this.handler_out=c,this.was_down=!1,this.text=null,this.out=new Phaser.GameObjects.Image(this.scene,0,0,s,n),this.over=new Phaser.GameObjects.Image(this.scene,0,0,s,o),this.down=new Phaser.GameObjects.Image(this.scene,0,0,s,r),this.out.setScale(u),this.over.setScale(u),this.down.setScale(u),this.add(this.out),this.add(this.over),this.add(this.down),this.x=t,this.y=a,this.out.setInteractive({useHandCursor:!0}),this.set_out(),this.out.on("pointerdown",(function(){return l.set_down()})),this.out.on("pointerover",(function(){l.set_over(),l.handler_over&&l.handler_over.apply(_,d)})),this.out.on("pointerout",(function(){l.set_out(),l.handler_out&&l.handler_out.apply(_,d)})),this.out.on("pointerup",(function(){l.was_down&&(l.set_over(!1),l.click.apply(_,d),l.was_down=!1)}))},set_handler:function(e){this.click=e},set_over:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.over.visible=!0,this.down.visible=!1,e&&game_data.audio_manager.sound_event({play:!0,sound_name:"button_over"})},set_out:function(){this.over.visible=!1,this.down.visible=!1,this.was_down=!1},set_down:function(){this.over.visible=!1,this.down.visible=!0,this.was_down=!0,game_data.audio_manager.sound_event({play:!0,sound_name:"button_click"})},addText:function(e){this.text&&this.destroy(),this.text=e,this.text.setOrigin(.5),this.add(this.text)},setText:function(e){this.text&&this.text.setText(e)}}),GameUtils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(e){this.scene=game_data.scene,this.emitter=new Phaser.Events.EventEmitter,this.create_overlay()}},{key:"create_overlay",value:function(){var e=new Phaser.Geom.Rectangle(0,0,loading_vars.W,loading_vars.H),t=this.scene.add.graphics({fillStyle:{color:0,alpha:1}});t.fillRectShape(e),t.generateTexture("dark_overlay",loading_vars.W,loading_vars.H),t.destroy()}},{key:"init_loading",value:function(){this.loading_overlay=new LoadingOverlay(this.scene),this.scene.add.existing(this.loading_overlay),this.loading_overlay.visible=!1,this.loading_overlay.alpha=0,this.create_missclick()}},{key:"create_missclick",value:function(){var e={key:"mistake_anim",frames:this.scene.anims.generateFrameNames("common1",{prefix:"mistake_anim",end:28,zeroPad:4}),repeat:0,showOnStart:!0,hideOnComplete:!0};this.scene.anims.create(e),this.mistake_anim=this.scene.add.sprite(-20,-20,"mistake_anim"),this.mistake_anim.setOrigin(.5,.8),this.global_missclick_down=null,this.global_missclick_up=null,this.global_missclick_holder=new Phaser.GameObjects.Container(this.scene,0,0),this.scene.add.existing(this.global_missclick_holder)}},{key:"add_loading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.loading_overlay.visible=!0,this.loading_overlay.start(t),game_data.loading_last_time=this.get_time(),game_data.scene.tweens.add({targets:this.loading_overlay,alpha:1,duration:100,onComplete:function(){e&&e()}})}},{key:"remove_loading",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=1e3,s=this.get_time()-game_data.loading_last_time;s<i?s=i-s:s>i&&(s=10),a&&(s=10),setTimeout((function(){game_data.scene.tweens.add({targets:e.loading_overlay,alpha:0,duration:100,onComplete:function(){e.loading_overlay.visible=!1,e.loading_overlay.stop()}}),t&&t()}),s)}},{key:"assign_to_global_missclick",value:function(e){var t=this;e.on("pointerdown",(function(e){var a=parseInt(1e6*Math.random());t.global_missclick_down=a,null==t.global_missclick_up&&(t.global_missclick_up=a)})),e.on("pointerup",(function(e){e&&t.mistake_anim&&t.global_missclick_up==t.global_missclick_down&&t.make_global_missclick(e),t.global_missclick_up=null}))}},{key:"make_global_missclick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==e&&(e=this.scene.input.activePointer);var t=new Phaser.Geom.Point(e.worldX,e.worldY);this.mistake_anim.x=t.x,this.mistake_anim.y=t.y,this.global_missclick_holder.add(this.mistake_anim),this.mistake_anim.play("mistake_anim"),game_data.audio_manager.sound_event({event:"sound_event",play:!0,sound_name:"wrong_click"})}},{key:"load_xmls_preloaded",value:function(e){var t=this;setTimeout((function(){t.read_language(),e()}),20)}},{key:"is_map",value:function(){return"MAP"===game_data.current_scene}},{key:"is_gameplay",value:function(){return"GAMEPLAY"===game_data.current_scene}},{key:"read_language",value:function(){var e,t,a,i,s,n,o,r={},_=game_data.langs,l=phaser_game.cache.xml.get("language_xml").getElementsByTagName("DYNAMIC_PHRASE");for(e=0;e<l.length;e++){a=l[e].getAttributeNode("scene_id").textContent,s=l[e].getAttributeNode("item_id").textContent,i=l[e].getAttributeNode("phrase_id").textContent,a in r||(r[a]={}),s in r[a]||(r[a][s]={}),i in r[a][s]||(r[a][s][i]={});for(t=0;t<_.length;t++)n=_[t].toUpperCase(),o=l[e].getElementsByTagName(n)[0]?n:"EN",r[a][s][i][n]={text:l[e].getElementsByTagName(o)[0].getElementsByTagName("TEXT")[0].textContent,size:parseInt(l[e].getElementsByTagName(o)[0].getElementsByTagName("SIZE")[0].textContent)}}game_data.language=r}},{key:"zeros",value:function(e){for(var t=[],a=0;a<e;a++)t.push(0);return t}},{key:"int_array",value:function(e){for(var t=[],a=0;a<e.length;a++)"-"==e[a]?t.push(-1):t.push(parseInt(e[a]));return t}},{key:"empty_line",value:function(e){for(var t=[],a=0;a<e;a++)t.push("-");return t}},{key:"fill_line",value:function(e,t){for(var a=[],i=0;i<e.length;i++)a.push("-"==e[i]?"-":t);return a}},{key:"toLocal",value:function(e,t){var a,i,s=[],n=e;for(i=t?new Phaser.Geom.Point(t.x,t.y):new Phaser.Geom.Point(0,0);n&&n!=this.scene;)s.push(n),n=n.parentContainer;for(;s.length>0;)a=s.pop(),i.x=(i.x-a.x)/a.scaleX,i.y=(i.y-a.y)/a.scaleY;return i}},{key:"toGlobal",value:function(e,t){var a;a=t?new Phaser.Geom.Point(t.x,t.y):new Phaser.Geom.Point(0,0);for(var i=e;i&&i!=this.scene;)a.x=a.x*i.scaleX+i.x,a.y=a.y*i.scaleY+i.y,i=i.parentContainer;return a}},{key:"fly_items",value:function(e,t){var a;game_data.allow_fly=!0;var i,s=e.amount;for(a=0;a<s;a++)i=a==s-1?t:function(){},this.show_moving_item(e,50*a,i)}},{key:"show_moving_item",value:function(e,t,a){var i=this,s=e.item_atlas,n=e.item_name,o=e.holder,r=this.toLocal(o,e.pt_start),_=this.toLocal(o,e.pt_end),l=new Phaser.GameObjects.Image(this.scene,0,0,s,n);if(l.x=r.x,l.y=r.y,o&&o.scene){o.add(l);var d=this.toGlobal(o,r),h=loading_vars.W/2,c=loading_vars.H/2;d.y>c&&(c=.2*loading_vars.H),d.x>h&&(h=d.x);var u=new Phaser.Geom.Point(h,c);u=this.toLocal(o,u),setTimeout((function(){game_data.utils.bezier(r,u,_,l,500,"Sine.easeOut",i,(function(){i.add_light_stars(e.pt_end,o,a),l.destroy()}))}),t)}}},{key:"add_light_stars",value:function(e,t,a){if("allow_fly"in game_data||(game_data.allow_fly=!0),game_data.allow_fly)for(var i,s,n,o,r=this.toLocal(t,e),_=0;_<15;_++)(i=new Phaser.GameObjects.Image(this.scene,0,0,"common1","light_star")).x=r.x-20*(Math.random()-.5),i.y=r.y-20*(Math.random()-.5),s=60*Math.random()-30,n=Math.sqrt(900-s*s)*(2*Math.floor(2*Math.random())-1),o=14==_?a:null,this.move_light_star(i,new Phaser.Geom.Point(i.x+s,i.y+n),t,o)}},{key:"move_light_star",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;a&&a.scene&&a.add(e),game_data.scene.tweens.add({targets:e,x:t.x,y:t.y,duration:100+150*Math.random(),onComplete:function(){game_data.scene.tweens.add({targets:e,alpha:0,duration:100,onComplete:function(){e.destroy(),i&&i()}})}})}},{key:"bezier",value:function(e,t,a,i,s,n,o){var r,_=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,c=arguments.length>11&&void 0!==arguments[11]?arguments[11]:{x:0,y:0},u=!1;h&&(h.stop(),u=!0),r=null!=l?new Phaser.Curves.CubicBezier(e,l,t,a):new Phaser.Curves.QuadraticBezier(e,t,a),i.bezier_val=0,game_data.scene.tweens.add({targets:i,bezier_val:1,duration:s,delay:d,ease:n,callbackScope:o,onUpdate:function(e,t){var a=r.getPoint(i.bezier_val);i.x=a.x,i.y=a.y,u&&i.bezier_val>.9?(h.stop(),u=!1):h&&h.setPosition(i.x+c.x,i.y+c.y)},onComplete:function(){i.x=a.x,i.y=a.y,u&&h.stop(),_&&_()}}),h&&h.start()}},{key:"init_tips",value:function(){this.tip_overlay=new Phaser.GameObjects.Container(this.scene,0,0),this.tip_overlay.visible=!1,this.scene.add.existing(this.tip_overlay),this.tip_dark=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.tip_dark.setOrigin(0,0),this.tip_dark.alpha=.4,this.tip_overlay.add(this.tip_dark),this.tip_bg=new Phaser.GameObjects.Image(this.scene,0,0,"common1","tip_bg"),this.tip_bg_origin=.04,this.tip_bg.setOrigin(this.tip_bg_origin,0),this.tip_overlay.add(this.tip_bg),this.tip_dark.setInteractive(),this.tip_dark.on("pointerup",this.hide_tip,this)}},{key:"place_tip",value:function(e,t,a,i){var s=this.tip_bg_origin,n=t.displayWidth,o=t.displayHeight,r=this.toLocal(a,i),_=8,l=4;"money_tip"==e&&(s=this.money_tip_bg_origin,_=5,l=2);var d=r.x,h=r.y,c=(r.y<loading_vars.H-o?"top":"down")+"_"+(r.x<loading_vars.W-n?"left":"right"),u=Math.abs(t.scaleX),m=Math.abs(t.scaleY);return"top_left"==c&&(d+=n*(.5-s)+l,h+=.5*o+_),"top_right"==c&&(u*=-1,d-=n*(.5-s)-l,h+=.5*o+_),"down_left"==c&&(m*=-1,d+=n*(.5-s)+l,h-=.5*o+_),"down_right"==c&&(u*=-1,m*=-1,d-=n*(.5-s)-l,h-=.5*o+_),t.setScale(u,m),t.x=r.x,t.y=r.y,{tx:d,ty:h}}},{key:"show_tip",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.forced||!this.tip_showing&&!game_data.game_windows.game_window){var i,s=this.tip_overlay;s.on_hide=a,this.tip_showing=!0,this.tip_hidable=!1,this.tip_text&&this.tip_text.destroy(),this.tip_img&&this.tip_img.destroy();var n=this.place_tip("common",this.tip_bg,s,e.pt),o=n.tx,r=n.ty,_=_objectSpread(_objectSpread({},game_data.styles.light_text2),{},{fontFamily:"font1",fontSize:24,align:"center",wordWrap:{width:270}});i=this.generate_string({scene_id:e.scene_id,item_id:e.item_id,phrase_id:e.phrase_id,values:e.values,base_size:24}),_.fontSize=i.size,this.tip_text=new Phaser.GameObjects.Text(this.scene,o,r,i.text,_),this.tip_text.setLineSpacing(-5),this.tip_text.setOrigin(.5),this.paused_tip=null,this.tip_overlay.add(this.tip_text),s.alpha=0,s.visible=!0,game_data.scene.tweens.add({targets:s,alpha:1,duration:150}),setTimeout((function(){t.tip_hidable=!0}),150),this.tid_tip_auto_hide&&clearTimeout(this.tid_tip_auto_hide),e.hide_timeout&&(this.tid_tip_auto_hide=setTimeout((function(){t.hide_tip()}),e.hide_timeout))}else this.paused_tip={params:e,on_hide:a}}},{key:"resume_tip",value:function(){this.paused_tip&&this.show_tip(this.paused_tip.params,this.paused_tip.on_hide)}},{key:"hide_tip",value:function(){var e=this;if(this.tip_hidable){this.tip_hidable=!1;var t=this.tip_overlay;this.scene.tweens.add({targets:t,alpha:0,duration:150,onComplete:function(){t.visible=!1,e.tip_text&&e.tip_text.destroy(),e.tip_text=null,t.on_hide&&t.on_hide(),t.on_hide=null,e.tip_showing=!1,e.resume_tip()}}),this.tid_tip_auto_hide&&clearTimeout(this.tid_tip_auto_hide)}}},{key:"generate_string",value:function(e){var t,a=game_data.user_data.lang.toUpperCase();game_data.langs.indexOf(game_data.user_data.lang)<0&&(a="EN");var i=e.scene_id,s=e.item_id,n=String(e.phrase_id),o=e.base_size,r={},_={};try{_=game_data.language[i][s][n][a]}catch(e){_={text:"missed_text",size:0}}r.size=o+_.size;var l=_.text;if("values"in e){var d=e.values,h=l,c=/%val/;for(t=0;t<d.length;t++)(h=h.replace(c,d[t])).indexOf("[")>=0&&(h=this.replace_correct_word(h,d[t],a));l=h}return l=l.replace(/\\n/gi,"\n"),r.text=l,r}},{key:"replace_correct_word",value:function(e,t,a){var i,s,n,o,r;if(0,0,i=e.indexOf("[",0),s=e.indexOf("]",0),i>=0&&s>=0&&s>i&&(n=e.substr(i,s-i+1),r=e.substr(i+1,s-i-1).split(",")),o="","RU"==a&&3==r.length)if(t%100>10&&t%100<20)o=r[2];else switch(t%10){case 0:case 5:case 6:case 7:case 8:case 9:o=r[2];break;case 1:o=r[0];break;case 2:case 3:case 4:o=r[1]}else 2==r.length&&(o=1==t?r[0]:r[1]);return o.length>0&&(e=e.replace(n,o)),e}},{key:"get_time",value:function(){return(new Date).getTime()}},{key:"get_passed_amount",value:function(){return game_data.user_data&&game_data.user_data.levels_passed?game_data.user_data.levels_passed.length:0}},{key:"check_ads",value:function(e){if(game_data.ads&&game_data.ads.interstitial){var t=game_data.ads.interstitial.event_mult;if(t){var a=100;e in t&&(a*=t[e]),100*Math.random()<a&&this.show_interstitial_ad()}}}},{key:"check_matrix_empty",value:function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e[t].length;a++)if("-"!=e[t][a]&&"0"!=e[t][a])return!1;return!0}},{key:"getNumbers",value:function(e){for(var t=[],a=1;a<=e;a++)t.push(a);return t}},{key:"get_random_from_2d",value:function(e,t,a){if(!Array.isArray(e))return null;var i,s;do{i=parseInt(Math.random()*t),s=parseInt(Math.random()*a)}while(!e[i]||!e[i][s]||"-"===e[i][s]);return[i,s]}},{key:"show_loader",value:function(e,t){var a,i=[];"loader_anims"in game_data||(game_data.loader_anims={total:0,period:1e3,circles:{},hidden:{}});var s=game_data.loader_anims.total;game_data.loader_anims.circles[s]=[];for(var n=0;n<9;n++)(a=new Phaser.GameObjects.Graphics(this.scene)).fillStyle(10066329,1),a.fillCircle(e.x+30*Math.cos(40*n/180*Math.PI),e.y+30*Math.sin(40*n/180*Math.PI),8),t.add(a),i.push(a),game_data.loader_anims.circles[s].push(a),this.show_circle_fade(s,n,1e3/9*n);return game_data.loader_anims.total++,s}},{key:"show_circle_fade",value:function(e,t,a){var i=this,s=game_data.loader_anims.circles[e][t],n=game_data.loader_anims.period;this.scene.tweens.add({targets:s,alpha:0,duration:n,delay:a,onComplete:function(){e in game_data.loader_anims.hidden?s.destroy():(s.alpha=1,i.show_circle_fade(e,t,0))}})}},{key:"hide_loader",value:function(e){for(var t=0;t<game_data.loader_anims.circles[e].length;t++)game_data.loader_anims.circles[e][t].visible=!1;game_data.loader_anims.hidden[e]=!0}},{key:"show_interstitial_ad",value:function(){navigator.onLine&&0===game_data.user_data.payments.total&&game_data.socialApi.show_interstitial_ad()}},{key:"show_rewarded_ad",value:function(e){navigator.onLine&&allow_rewarded_ads?game_data.socialApi.show_rewarded_ad(e):e({success:!1})}},{key:"purchase",value:function(e,t){game_data.wait_for_purchase=!0,game_data.socialApi.purchase(e,(function(e){game_data.wait_for_purchase=!1,t(e)}))}},{key:"update_language",value:function(){game_request.update_language()}},{key:"get_loader",value:function(){return new Phaser.Loader.LoaderPlugin(game_data.scene)}},{key:"show_components",value:function(e){var t=this;e&&"Container"===e.type&&e.each((function(e){return t.show_components(e)}))}},{key:"delayed_call",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},a=game_data.scene.time.delayedCall(e,(function(){t(),setTimeout((function(){a.remove(),a.destroy(!0)}),10)}));return a}},{key:"deep_copy",value:function(e){var t,a,i;if("object"!==_typeof(e)||null===e)return e;for(i in t=Array.isArray(e)?[]:{},e)a=e[i],t[i]=this.deep_copy(a);return t}},{key:"lock_game",value:function(){game_data.game_overlay.visible=!0}},{key:"unlock_game",value:function(){game_data.game_overlay.visible=!1}},{key:"average",value:function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a];return Math.floor(t/e.length)}},{key:"linspace",value:function(e,t,a){for(var i=[],s=(t-e)/(a-1),n=0;n<a;n++)i.push(e+s*n);return i}},{key:"createRangeWithStep",value:function(e,t,a){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof a)throw new Error("Start, end, and step values must be numbers.");if(e>t&&a>0)throw new Error("Invalid range: start is greater than end, but step is positive.");if(e<t&&a<0)throw new Error("Invalid range: start is less than end, but step is negative.");for(var i=[],s=e;a>0?s<=t:s>=t;s+=a)e!==s&&t!==s&&i.push(s);return i}},{key:"vector",value:function(e,t){return{x:t.x-e.x,y:t.y-e.y}}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"happy_moment",value:function(){game_data.socialApi.happy_moment()}},{key:"game_play_start",value:function(){game_data.socialApi.game_play_start()}},{key:"game_play_stop",value:function(){game_data.socialApi.game_play_stop()}},{key:"update_level",value:function(e){game_data.socialApi.update_level(e)}},{key:"update_score",value:function(e){game_data.socialApi.update_score(e),game_data.game_map.new_score()}},{key:"show_leaderboard",value:function(e){game_data.socialApi.show_leaderboard(e)}},{key:"update_leaderboard",value:function(e){game_data.socialApi.update_leaderboard(e)}},{key:"get_user_stars",value:function(){return game_data.user_data.levels_passed.reduce((function(e,t){return e+t}),0)}},{key:"page_requered_stars",value:function(){var e=20*((arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1),t=this.get_user_stars(),a=0;for(var i in game_data.required_stars){if(e<=(i=Number(i)))break;a=game_data.required_stars[i]}var s=a-t;return s>0?s:0}},{key:"is_level_available",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)-1<=this.get_passed_amount()}},{key:"get_level",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=levels[e-1].pictures,s=game_data.urls.levels,n=this.scene.textures;if(i.every((function(t){return n.exists("level".concat(e,"_").concat(t))})))a({success:!0});else if(navigator.onLine){var o=new Phaser.Loader.LoaderPlugin(this.scene);this.add_loading(),i.forEach((function(t){o.image("level".concat(e,"_").concat(t),s+"level".concat(e,"/")+t+".webp")})),o.once("complete",(function(){t.remove_loading(),a({success:!0}),o.off("loaderror"),o.destroy()}),this),o.once("loaderror",(function(){throw"Broken level!!!\n".concat(s,"\n").concat(e)})),o.start()}else a({success:!1,no_internet:!0})}},{key:"remove_level_from_cache",value:function(e){var t=this.scene.textures;levels[e-1].pictures.forEach((function(a){t.exists("level".concat(e,"_").concat(a))&&t.remove("level".concat(e,"_").concat(a))}))}},{key:"generate_levels",value:function(){for(var e=[[{x:114,y:176,radius:60},{x:170,y:552,radius:75},{x:402,y:123,radius:60},{x:518,y:355,radius:100},{x:774,y:127,radius:50},{x:757,y:573,radius:60},{x:1076,y:439,radius:45},{x:1069,y:159,radius:80},{x:823,y:320,radius:60}],[{x:250,y:186,radius:110},{x:971,y:492,radius:100},{x:893,y:138,radius:95},{x:250,y:510,radius:100},{x:486,y:98,radius:60},{x:606,y:232,radius:55},{x:719,y:374,radius:60},{x:590,y:497,radius:40},{x:486,y:575,radius:45}],[{x:952,y:189,radius:105},{x:183,y:510,radius:100},{x:1163,y:79,radius:35},{x:204,y:178,radius:30},{x:405,y:125,radius:30},{x:646,y:149,radius:30},{x:443,y:331,radius:30},{x:716,y:331,radius:30},{x:510,y:521,radius:30},{x:737,y:591,radius:30},{x:882,y:422,radius:30},{x:981,y:607,radius:30},{x:1185,y:626,radius:30},{x:1062,y:414,radius:30}],[{x:215,y:146,radius:30},{x:1011,y:585,radius:30},{x:1145,y:427,radius:30},{x:1105,y:208,radius:30},{x:946,y:87,radius:45},{x:646,y:253,radius:30},{x:410,y:393,radius:55},{x:153,y:580,radius:30},{x:518,y:615,radius:30},{x:826,y:618,radius:30},{x:887,y:343,radius:110},{x:147,y:311,radius:80},{x:501,y:129,radius:80}],[{x:184,y:546,radius:30},{x:960,y:541,radius:55},{x:1138,y:581,radius:30},{x:783,y:373,radius:60},{x:1113,y:152,radius:45},{x:698,y:132,radius:30},{x:633,y:263,radius:30},{x:286,y:58,radius:30},{x:267,y:266,radius:30},{x:449,y:307,radius:60},{x:140,y:397,radius:60},{x:943,y:169,radius:60},{x:580,y:421,radius:60},{x:353,y:576,radius:60},{x:811,y:576,radius:30},{x:1150,y:456,radius:45}]],t=[20,20,25,42,44],a=4;a<=40;a++){var i=Phaser.Utils.Array.GetRandom(e),s=t[e.indexOf(i)],n=Phaser.Utils.Array.GetRandom(e),o=t[e.indexOf(n)],r=Phaser.Utils.Array.GetRandom(e),_=e.indexOf(r);"\n\t\t\t{\n\t\t\t\ttime: ".concat(s+o+t[_],",\n\t\t\t\tpictures: [\n\t\t\t\t\t'1',\n\t\t\t\t\t'2',\n\t\t\t\t\t'3'\n\t\t\t\t],\n\t\t\t\tpoints: [\n\t\t\t\t\t").concat(JSON.stringify(i),",\n\t\t\t\t\t").concat(JSON.stringify(n),",\n\t\t\t\t\t").concat(JSON.stringify(r),"\n\t\t\t\t]\n\t\t\t},\n\t\t\t")}}}]),e}(),GraphicsManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){this.scene=game_data.scene,this.emitter=new Phaser.Events.EventEmitter,this.create_window_data()}},{key:"create_window_data",value:function(){this.close_pos={info:{x:105,y:-155}},this.btn_pos={info:{x:0,y:150}},this.title_pos={info:{x:0,y:-170}},game_data.close_pos=this.close_pos,game_data.title_pos=this.title_pos,game_data.btn_pos=this.btn_pos,this.title_style=_objectSpread(_objectSpread({fontFamily:"font2"},game_data.styles.title),{},{align:"center"})}},{key:"get_window",value:function(e,t,a,i){var s,n,o,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,_=this.close_pos[e],l=this.title_pos[e],d=this.btn_pos[e],h=this.title_style;if(e&&((n=new Phaser.GameObjects.Image(game_data.scene,0,0,"common1","panel14")).setInteractive(),i.add(n),i.back=n,game_data.utils.assign_to_global_missclick(n,i)),t){var c=new CustomButton(game_data.scene,_.x,_.y,t,"common1","icon_close","icon_close","icon_close",i);i.button_close=c,i.add(c)}r&&(r.base_size=parseInt(this.title_style.fontSize),i.title=new Phaser.GameObjects.Text(this.scene,l.x,l.y,"",h),o=game_data.utils.generate_string(r),i.title.text=o.text.toUpperCase(),i.title.setFontSize(o.size),i.title.setOrigin(.5),i.title.setWordWrapWidth(250),i.add(i.title));var u=[];for(s=0;s<a.length;s++){var m=a[s].handler,g="scale"in a[s]?a[s].scale:1,p=new CustomButton(game_data.scene,d.x,d.y,m,"common1","btn_play2","btn_play2","btn_play2",i,null,null,g);u.push(p),i.add(p)}i.buttons=u}}]),e}(),LoadingOverlay=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter,this.create_assets()},create_assets:function(){this.default_overlay=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.default_overlay.setOrigin(0,0),this.default_overlay.alpha=1,this.add(this.default_overlay),this.default_overlay.setInteractive(),this.items=[];var e=["but_1","but_2","but_3","but_4","but_1","but_2"];this.num=e.length,this.rot_angle=2*Math.PI/this.num,this.radius=140,this.pos=0,this._x=loading_vars.W/2,this._y=loading_vars.H/2;var t=0,a=this.scene.add.image(this._x,this._y,"common1","gamepad");for(this.add(a),this.circle=new Phaser.GameObjects.Container(this.scene,this._x,this._y),this.minor_loader=new Phaser.GameObjects.Container(this.scene,0,0),a=this.scene.add.image(0,0,"common1","gamepad"),this.minor_loader.add(a),this.minor_loader_cont=new Phaser.GameObjects.Container(this.scene,0,0),this.minor_loader.add(this.minor_loader_cont),this.add(this.circle),t=0;t<this.num;t++){var i=this.scene.add.image(Math.sin(this.rot_angle*t)*this.radius,Math.cos(this.rot_angle*t)*this.radius,"common1",e[t]);i.angle=-360/this.num*t+180,this.circle.add(i),this.items.push(i),(i=this.scene.add.image(Math.sin(this.rot_angle*t)*this.radius,Math.cos(this.rot_angle*t)*this.radius,"common1",e[t])).angle=-360/this.num*t+180,this.minor_loader_cont.add(i)}this.playing=!1,this.allow_anim=!0,game_data.minor_loader=this.minor_loader,this.run_minor()},handler_timer:function(){var e=this;this.pos++,this.pos>=this.num&&(this.pos=0),game_data.scene.tweens.add({targets:this.circle,alpha:.5,duration:50,onComplete:function(){e.circle.x=Math.sin(-e.rot_angle*e.pos)*e.radius+e._x,e.circle.y=Math.cos(-e.rot_angle*e.pos)*e.radius+e._y,game_data.scene.tweens.add({targets:e.circle,alpha:1,duration:50})}})},start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.default_overlay.alpha=e,this.playing||(this.playing=!0,this.run_anim())},stop:function(){this.playing=!1},run_anim:function(){var e=this;this.allow_anim&&this.playing&&(this.allow_anim=!1,this.circle.angle=0,game_data.scene.tweens.add({targets:this.circle,angle:360,duration:3e3,onComplete:function(){e.allow_anim=!0,e.run_anim()}}))},run_minor:function(){var e=this;this.minor_loader_cont.angle=0,game_data.scene.tweens.add({targets:this.minor_loader_cont,angle:360,duration:3e3,onComplete:function(){e.run_minor()}})}}),SocialApi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"make_share",value:function(e,t){is_localhost&&t({success:!0})}},{key:"create_wall_post",value:function(e,t){t({success:!1})}},{key:"show_invite",value:function(){}},{key:"get_game_size",value:function(){return{W:window.innerWidth,H:window.innerHeight-20}}},{key:"set_game_size",value:function(){var e,t,a=document.querySelector("canvas");if("scene"in game_data&&game_data.scene.scale.isFullscreen)e=window.innerWidth,t=window.innerHeight;else{var i=this.get_game_size();e=i.W,t=i.H}var s=e/t,n=phaser_game.config.width/phaser_game.config.height;s<n?(a.style.width=e+"px",a.style.height=e/n+"px"):(a.style.height=t+"px",a.style.width=t*n+"px")}},{key:"show_interstitial_ad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};game_data.test_ad?(pause(),game_data.test_ad_manager.call_ad({type:"interstitial"},(function(){resume(),e()}))):e()}},{key:"show_rewarded_ad",value:function(e){game_data.test_ad?(pause(),game_data.test_ad_manager.call_ad({type:"rewarded"},(function(){resume(),e({success:!0})}))):e({success:!0})}},{key:"happy_moment",value:function(e){}},{key:"game_play_start",value:function(e){}},{key:"game_play_stop",value:function(e){}},{key:"update_score",value:function(e){}},{key:"update_level",value:function(e){}},{key:"update_leaderboard",value:function(e){e.type,e.amount}},{key:"purchase",value:function(e,t){t({success:!0,item_info:e.item_info})}}]),e}(),YourNetApi=function(e){_inherits(a,SocialApi);var t=_createSuper(a);function a(){return _classCallCheck(this,a),t.call(this,{})}return _createClass(a,[{key:"purchase",value:function(e,t){if(navigator.onLine){var a=e.item_info;TestApi.purchaseAsync({itemID:a.item_id}).then((function(a){t({success:!0,item_info:e.item_info})})).catch((function(e){t({success:!1})}))}else t({success:!1})}},{key:"show_invite",value:function(){TestApi.InviteCall()}},{key:"create_wall_post",value:function(e,t){TestApi.WallPostTestCall()}},{key:"make_share",value:function(e){TestApi.ShareCall()}},{key:"show_interstitial_ad",value:function(){TestApi.InterstitialTestCall()}},{key:"show_rewarded_ad",value:function(e){TestApi.RewardedTestCall().then((function(){e({success:!0})})).catch((function(t){e({success:!1})}))}},{key:"happy_moment",value:function(e){}}]),a}(),Y=function(e){_inherits(a,SocialApi);var t=_createSuper(a);function a(){return _classCallCheck(this,a),t.call(this,{})}return _createClass(a,[{key:"show_interstitial_ad",value:function(){YAPI.InterstitialTestCall()}},{key:"show_rewarded_ad",value:function(e){YAPI.RewardedTestCall().then((function(){e({success:!0})})).catch((function(t){e({success:!1})}))}},{key:"purchase",value:function(e,t){if(navigator.onLine){var a=e.item_info;YAPI.purchaseAsync({itemID:a.item_id}).then((function(a){t({success:!0,item_info:e.item_info})})).catch((function(e){t({success:!1})}))}else t({success:!1})}}]),a}(),DefaultApi=function(e){_inherits(a,SocialApi);var t=_createSuper(a);function a(){return _classCallCheck(this,a),t.call(this,{})}return _createClass(a,[{key:"init",value:function(e){e({user_id:"0"})}}]),a}(),TestAdManager=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter,this.create_assets()},create_assets:function(){this.default_overlay=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.default_overlay.setOrigin(0,0),this.default_overlay.alpha=1,this.add(this.default_overlay),this.default_overlay.setInteractive(),this.value_txt=new Phaser.GameObjects.Text(this.scene,loading_vars.W/2,loading_vars.H/2,"5",{fontFamily:"font2",fontSize:90,color:"#fff"}),this.value_txt.setOrigin(.5),this.add(this.value_txt),this.desc_txt=new Phaser.GameObjects.Text(this.scene,loading_vars.W/2,this.value_txt.y+70,"Test desc",{fontFamily:"font2",fontSize:45,color:"#fff"}),this.desc_txt.setOrigin(.5),this.add(this.desc_txt),this.setVisible(!1)},call_ad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.setVisible(!0);var i=e.type,s=game_data.utils.generate_string({scene_id:"test_ad",item_id:i,phrase_id:"1",values:[],base_size:45});this.desc_txt.setText(s.text),this.desc_txt.setFontSize(s.size);var n={val:5};this.value_txt.setText(n.val),game_data.scene.tweens.add({targets:n,val:0,duration:1e3*n.val,onUpdate:function(){t.value_txt.setText(Math.ceil(n.val))},onComplete:function(){t.setVisible(!1),a()}})}}),BuyMoney=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){var t=new CustomButton(game_data.scene,550,-250,this.handler_close,"common1","icon_close","icon_close","icon_close",this);this.add(t);var a=game_data.utils.generate_string({scene_id:"shop",item_id:"1",phrase_id:"1",values:[],base_size:60}),i=new Phaser.GameObjects.Text(this.scene,0,-250,a.text,_objectSpread(_objectSpread({},game_data.styles.title),{},{fontFamily:"font1",fontSize:a.size,align:"center"}));i.setOrigin(.5),this.add(i),this.title=i,this.money_pt=e.money_pt;var s=[{x:-370,y:0},{x:-120,y:0},{x:130,y:0},{x:380,y:0}];this.shop_list=[],this.shop_list=game_data.shop.filter((function(e,t,a){return"money"==e.type})),this.shop_list.sort((function(e,t){return e.amount<t.amount?-1:t.amount<e.amount?1:0}));for(var n=0;n<this.shop_list.length&&n<s.length;n++){var o=new BuyMoneyItem(this.scene);o.x=s[n].x,o.y=s[n].y,this.add(o),o.init({item_info:this.shop_list[n],free:!1,no:String(n+1),icon:"money_"+String(n+1),money_pt:this.money_pt,holder:this}),o.emitter.on("EVENT",this.handler_event,this)}this.no_ads_cont=new Phaser.GameObjects.Container(this.scene,-30,-50),this.add(this.no_ads_cont),(i=new Phaser.GameObjects.Image(this.scene,30,320,"common1","panel2")).scaleX=1.2,this.no_ads_cont.add(i),str_obj={scene_id:"game_windows",item_id:"buy_money",phrase_id:"tip",values:[],base_size:20},a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"buy_money",phrase_id:"tip",values:[],base_size:28}),(i=new Phaser.GameObjects.Text(this.scene,-45,320,a.text,_objectSpread(_objectSpread({},game_data.styles.light_text2),{},{fontFamily:"font1",fontSize:a.size,wordWrap:{width:300}}))).setOrigin(0,.5),this.no_ads_cont.add(i),this.no_ads_txt=i,(i=new Phaser.GameObjects.Image(this.scene,i.x-55,320,"common1","no_ads")).setScale(.8),this.no_ads_cont.add(i),this.no_ads_ico=i;var r=game_data.user_data.payments.total;this.no_ads_cont.setVisible(0===r)},handler_event:function(e){switch(e.event){case"shop_click":this.no_buy=!1;break;case"window_close":this.close_window(e);break;default:this.emitter.emit("EVENT",e)}},handler_close:function(e){this.close_window()},close_window:function(e){this.emitter.emit("EVENT",{event:"window_close"})}}),BuyMoneyItem=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){this.holder=e.holder,this.item_info=e.item_info,this.icon=new Phaser.GameObjects.Image(this.scene,0,0,"common1",e.icon),this.money_pt=e.money_pt,this.allow_buy=!0,this.bg=new CustomButton(this.scene,0,0,this.handler_buy,"common1","panel5","panel5","panel5",this),this.add(this.bg),this.add(this.icon);var t=new Phaser.GameObjects.Text(this.scene,0,-130,this.item_info.amount,{fontFamily:"font1",fontSize:45,color:"#f6caa0",stroke:"#886D13",strokeThickness:8});t.setOrigin(.5),this.add(t),this.button_buy=new CustomButton(this.scene,0,130,this.handler_buy,"common1","btn_play2","btn_play2","btn_play2",this),this.button_buy.setScale(.8),this.add(this.button_buy);var a=new Phaser.GameObjects.Text(this.scene,0,0,this.item_info.price,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:40}));a.setOrigin(.5),a.x=this.button_buy.x,a.y=this.button_buy.y-1,this.add(a),a.text=a.text+" $"},handler_buy:function(e){var t=this;this.allow_buy&&(this.allow_buy=!1,this.emitter.emit("EVENT",{event:"shop_click"}),setTimeout((function(){t.allow_buy=!0}),2e3),game_data.utils.purchase({item_info:this.item_info},(function(e){"success"in e&&e.success?game_request.request({update_purchase:!0,item_info:t.item_info},(function(e){t.scene&&t.display_add_money()})):t.emitter.emit("EVENT",{events:[{event:"window_close",immediate:!0},{event:"show_window",window_id:"purchase_failed",center_pt:t.center_pt}]})})))},display_add_money:function(){var e=this,t=new Phaser.Geom.Point(this.icon.x,this.icon.y);t=game_data.utils.toGlobal(this,t),setTimeout((function(){game_data.audio_manager.sound_event({event:"sound_event",play:!0,sound_name:"coin_add"})}),600),game_data.utils.fly_items({amount:5,holder:this.holder,item_atlas:"common1",item_name:"money_ico",pt_start:t,pt_end:this.money_pt},(function(){e.scene&&(e.emitter.emit("EVENT",{event:"update_money"}),e.emitter.emit("EVENT",{event:"window_close"}))}))},handler_close:function(e){this.close_window(e)},close_window:function(e){this.emitter.emit("EVENT",{event:"window_close"})}}),GameWindows=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(e){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,e,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){game_data.game_windows=this,this.game_window=null,this.overlay_bmd=null,this.wind_id="",this.create_dark(),this.allow_overlay_click=!0,this.pending_windows=[],this.window_holder=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.window_holder),this.moving_holder=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.moving_holder),this.allow_window_close=!1},create_dark:function(){var e=this;this.dark=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.dark.setOrigin(0),this.dark.alpha=.8,this.add(this.dark),this.dark.setInteractive(),this.dark.visible=!1,this.dark.on("pointerup",(function(){e.dark_click()}),this),this.dark.on("pointerdown",(function(){e.dark.has_down=!0,setTimeout((function(){e.dark.has_down=!1}),200)}),this),this.dark.has_down=!1},dark_click:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&"options"==this.wind_id&&(e=!1),this.game_window&&this.allow_overlay_click&&(this.dark.has_down||e)&&(this.allow_overlay_click=!1,this.dark.has_down=!1,this.game_window.handler_close({overlay:!0}))},show_window:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.window_id,s=this.no_muliple_window();e&&s?this.game_window||this.before_create||this.suspened&&this.suspened!=i?this.pending_windows.push(e):(this.before_create=!0,setTimeout((function(){t.before_create=!1,t.display_window(e)}),a)):this.destroy_window()},suspend_windows:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no_exception";this.suspened=e},resume_windows:function(){if(this.suspened=!1,this.pending_windows.length&&!this.game_window){var e=this.pending_windows.shift();this.show_window(e,100)}},no_muliple_window:function(e){if(this.wind_id==e)return!1;var t,a=_createForOfIteratorHelper(this.pending_windows);try{for(a.s();!(t=a.n()).done;){if(t.value.window_id==e)return!1}}catch(e){a.e(e)}finally{a.f()}return!0},display_window:function(e){var t=this;this.game_window&&this.close_window({immediate:!0});var a=e.window_id;switch(this.wind_id=a,a){case"buy_money":this.game_window=new BuyMoney;break;case"options":this.game_window=new Options;break;case"select_language":this.game_window=new SelectLanguage;break;case"level_failed":this.game_window=new LevelFailed;break;case"level_complete":this.game_window=new LevelComplete;break;case"purchase_success":this.game_window=new PurchaseSuccess(this.scene);break;case"purchase_failed":this.game_window=new PurchaseFailed(this.scene);break;case"select_language":this.game_window=new SelectLanguage(this.scene);break;case"quit":this.game_window=new Quit(this.scene);break;case"info":this.game_window=new Info(this.scene);break;case"example_window":this.game_window=new ExampleWindow(this.scene)}if(this.game_window){e.moving_holder=this.moving_holder,this.dark.visible||(this.dark.alpha=.01,this.dark.visible=!0),this.game_window.init(e),this.window_holder.add(this.game_window);var i="center_pt"in e&&e.center_pt?e.center_pt:new Phaser.Geom.Point(loading_vars.W/2,loading_vars.H/2-15);"immediate"in e?(this.dark.alpha=.8,this.game_window.x=i.x,this.game_window.y=i.y,this.game_window&&this.game_window.window_shown&&this.game_window.window_shown()):this.display_smooth(i,"center"),this.allow_window_close=!0,this.game_window.emitter.on("EVENT",this.handler_event,this),game_data.audio_manager.sound_event({play:!0,sound_name:"window_open"}),this.allow_overlay_click=!1,"level_failed"!==a&&setTimeout((function(){t.allow_overlay_click=!0}),500),game_data.game_play.pause_timer(),this.emitter.emit("EVENT",{event:"window_shown"})}},display_smooth:function(e,t){var a=this;game_data.scene.tweens.add({targets:this.dark,alpha:.8,duration:200}),"center"==t&&(this.game_window.x=e.x,this.game_window.y=e.y-1e3,game_data.scene.tweens.add({targets:this.game_window,y:e.y+20,ease:"Sine.easeOut",duration:350,onComplete:function(){game_data.scene.tweens.add({targets:a.game_window,y:e.y,duration:70})}}))},handler_event:function(e){if("events"in e)for(var t=e.events;t.length;)obj=t.shift(),this.handler_event(obj);else switch(e.event){case"window_close":this.close_window(e);break;case"show_window":this.show_window(e);break;default:this.emitter.emit("EVENT",e)}},create_default_overlay:function(e){var t=this;this.allow_destroy_overlay=!1,null==this.default_overlay&&(this.default_overlay=new Phaser.GameObjects.Image(this.scene,0,0,"dark_overlay"),this.default_overlay.setOrigin(0,0),this.default_overlay.alpha=.8,this.default_overlay.setInteractive(),this.default_overlay.on("pointerup",(function(){t.game_window&&t.allow_overlay_click&&(t.allow_overlay_click=!1,t.game_window.handler_close({overlay:!0}))}))),this.overlay_holder.add(this.default_overlay)},close_window:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.wind_id;if(this.allow_window_close)if(this.allow_window_close=!1,this.game_window.prize_mod&&(game_data.prize_mod=!1),t&&"immediate"in t)this.wind_id==a&&this.destroy_window();else{var i=this.game_window.x;this.pending_windows.length||game_data.scene.tweens.add({targets:this.dark,alpha:.01,delay:300,duration:200}),game_data.scene.tweens.add({targets:this.game_window,x:i-30,duration:70,onComplete:function(){game_data.audio_manager.sound_event({play:!0,sound_name:"window_open"}),game_data.scene.tweens.add({targets:e.game_window,x:i+1e3,duration:250,onComplete:function(){e.wind_id==a&&e.destroy_window()}})}})}},destroy_window:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.game_window&&this.game_window.destroy(),this.pending_windows&&this.pending_windows.length&&this.pending_windows[0]&&this.pending_windows[0].window_id||game_data.game_play.resume_timer(),this.wind_id="",this.window_holder.removeAll(!0),this.moving_holder.removeAll(!0),this.overlay_bmd&&(this.overlay_bmd.destroy(),this.overlay_bmd=null),!this.suspened&&this.pending_windows.length||(this.dark.visible=!1),this.allow_overlay_click=!0,this.game_window=null,this.emitter.emit("EVENT",{event:"window_closed",pending_length:this.pending_windows.length}),this.pending_windows.length){var t=this.pending_windows.shift();this.show_window(t)}else e||game_data.utils.resume_tip()}}),Info=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){this.close_callback=e.close_callback;game_data.graphics_manager.get_window("info",null,[{handler:this.handler_close,type:"big"}],this,{scene_id:"game_windows",item_id:"info",phrase_id:"1",values:[]},!0),this.button_play=this.buttons[0],this.button_play.setScale(.65),this.button_play.y=160,res=game_data.utils.generate_string({scene_id:"game_windows",item_id:"info",phrase_id:"3",values:[],base_size:55});var t=new Phaser.GameObjects.Text(this.scene,0,-3,res.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:res.size}));t.setOrigin(.5),this.button_play.add(t),this.tut_cont=new Phaser.GameObjects.Container(this.scene,0,-10),this.add(this.tut_cont);var a=new Phaser.GameObjects.Image(this.scene,0,0,"tut_1");this.tut_cont.add(a);var i=new Phaser.GameObjects.Image(this.scene,-27,-56,"tut_2").setAngle(180);this.tut_cont.add(i),this.tut_2=i,this.tap=new Phaser.GameObjects.Sprite(this.scene,0,-50,"common1","tap").setScale(.5).setAngle(-45).setAlpha(0),this.tut_cont.add(this.tap),this.tutorial_anim();var s=new Phaser.GameObjects.Image(this.scene,0,0,"common1","btn_comp").setAlpha(0);this.add(s),this.btn_comp=s},anim_tap:function(){this.scene&&this.scene.tweens.add({targets:[this.tap],ease:"Sine.easeInOut",duration:150,alpha:1,yoyo:!0,onComplete:function(){}})},tutorial_anim:function(){var e=this;clearTimeout(this.tut_tid),this.anim_tap(),this.scene&&this.scene.tweens.add({targets:[this.tut_2],ease:"Back.easeOut",delay:400,duration:600,angle:"+=45",onComplete:function(){e.anim_tap(),e.scene&&e.scene.tweens.add({targets:[e.tut_2],ease:"Back.easeOut",delay:500,duration:600,angle:"+=45",onComplete:function(){e.scene&&e.scene.tweens.add({targets:[e.btn_comp],ease:"Sine.easeInOut",duration:150,alpha:1,onComplete:function(){}}),e.tut_tid=setTimeout((function(){e.btn_comp.setAlpha(0),e.tut_2.setAngle(180),e.tutorial_anim()}),1200)}})}})},handler_close:function(e){this.close_window()},close_window:function(e){clearTimeout(this.tut_tid),this.close_callback(),this.emitter.emit("EVENT",{event:"window_close"})}}),LevelComplete=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){var t,a;this.paid_replay=!1,this.level_id=e.level_id,this.money_pt=e.money_pt,this.score=e.score,this.currentStageAdsWatched=e.currentStageAdsWatched,this.currentStage=e.currentStage,this.first_complete=e.first_complete,t={scene_id:"game_windows",item_id:"level_failed",phrase_id:"1",values:[]},game_data.graphics_manager.get_window("info",this.handler_close,[{handler:this.handler_cancel}],this,t,!0),this.button_play=this.buttons[0],this.button_close.setVisible(!1),this.back.y=200,this.title.y=20,this.button_play.y=320,a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"level_failed",phrase_id:"3",values:[],base_size:45}),(t=new Phaser.GameObjects.Text(this.scene,0,-2,a.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:a.size,align:"center"}))).setOrigin(.5),this.button_play.add(t),this.button_play.y+=20,this.each((function(e){return e.y-=100}));var i=new Phaser.GameObjects.Image(this.scene,0,20,"common1","star_unactive");this.add(i);var s=new Phaser.GameObjects.Image(this.scene,0,20,"common1","star_active");if(this.add(s),s.alpha=0,this.anim_star({icon:s},400),a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"complete_phrase",phrase_id:Phaser.Math.Between(1,12),values:[],base_size:38}),this.phrase=new Phaser.GameObjects.Text(this.scene,0,i.y+70,a.text,_objectSpread(_objectSpread({},game_data.styles.title),{},{fontFamily:"font1",fontSize:a.size})),this.phrase.setOrigin(.5),this.add(this.phrase),this.first_complete){var n=new Phaser.GameObjects.Text(this.scene,0,this.phrase.y+60,"+".concat(game_data.level_complete_prize),_objectSpread(_objectSpread({},game_data.styles.title),{},{fontFamily:"font1",fontSize:a.size}));n.setOrigin(1,.5),this.add(n);var o=new Phaser.GameObjects.Image(this.scene,n.x+28,this.phrase.y+60,"common1","money_ico").setScale(.77);this.add(o),this.money_ico=o}},anim_star:function(e,t){var a=this,i=e.icon;setTimeout((function(){if(a.scene){var e=i.x,t=i.y,s=i.angle;i.y-=350;var n=Math.random()<.5?1:-1;i.angle=-300*n,i.x+=(200*Math.random()+200)*n;var o={x:i.x,y:i.y},r={x:e,y:t},_={x:e+100*n,y:t-50},l=a.scene.add.particles(0,0,"common1",{frame:"star_active",follow:i,lifespan:1e3,blendMode:"ADD",alpha:{start:1,end:.2},scale:{start:.6,end:0},speed:{min:-200,max:200},quantity:4,gravityY:-50,rotate:{onEmit:function(){return 360*Math.random()}}});a.add(l),game_data.utils.bezier(o,_,r,i,600,"Sine.easeOut",a,(function(){a.scene&&setTimeout((function(){l.destroy()}),1200)}),null,0,l),game_data.scene.tweens.add({targets:i,alpha:1,duration:100}),game_data.scene.tweens.add({targets:i,angle:s-360,duration:600}),setTimeout((function(){a.scene&&!a.is_closed&&game_data.audio_manager.sound_event({play:!0,sound_name:"get_star"})}),500)}}),t)},handler_cancel:function(){var e=this;game_request.request({level_failed:!0,global_score:this.score,levels_passed:this.currentStage},(function(t){if(e.first_complete){var a=new Phaser.Geom.Point(e.money_ico.x,e.money_ico.y);a=game_data.utils.toGlobal(e,a),game_data.utils.fly_items({amount:3,holder:game_data.money_holder,item_atlas:"common1",item_name:"money_ico",pt_start:a,pt_end:e.money_pt},(function(){game_data.audio_manager.sound_event({event:"sound_event",play:!0,sound_name:"coin_add"}),e.emitter.emit("EVENT",{event:"update_money"})}))}t.new_score&&"global_score"in t&&game_data.utils.update_score(t.global_score),t.new_stage&&"levels_passed"in t&&game_data.utils.update_level(t.levels_passed),e.emitter.emit("EVENT",{event:"destroy_level"}),e.emitter.emit("EVENT",{event:"show_scene",scene_id:"MAP",first_complete:e.first_complete}),game_data.utils.remove_level_from_cache(e.level_id),game_data.utils.game_play_stop(),e.handler_close()}))},handler_close:function(e){this.closed||(this.closed=!0,this.close_window(),this.countdown_tween&&(this.countdown_tween.pause(),this.countdown_tween.remove()))},close_window:function(){game_data.utils.hide_tip(),this.emitter.emit("EVENT",{event:"window_close"})}}),LevelFailed=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){var t,a,i=this;this.paid_replay=!1,this.level_id=e.level_id,this.duel=e.duel,this.money_pt=e.money_pt,this.score=e.score,this.currentStageAdsWatched=e.currentStageAdsWatched,t={scene_id:"game_windows",item_id:"level_failed",phrase_id:"1",values:[]},game_data.graphics_manager.get_window("info",this.handler_close,[{handler:this.handler_replay}],this,t,!0),this.button_play=this.buttons[0],this.button_close.setVisible(!1),this.back.y=200,this.title.y=20,a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"level_failed",phrase_id:"2",values:[],base_size:45}),(t=new Phaser.GameObjects.Text(this.scene,0,-5,a.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:a.size,align:"center"}))).setOrigin(0,.5),t.x=-t.displayWidth/2+15,this.continue_txt=t,this.button_play.add(t),this.button_play.y=120;var s=new CustomButton(game_data.scene,0,220,this.handler_replay2,"common1","btn_play2","btn_play2","btn_play2",this,null,null,1);(t=new Phaser.GameObjects.Text(this.scene,23,-5,game_data.continue_level,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:45,align:"center"}))).setOrigin(.5),s.add(t),this.continue_txt2=t,this.add(s),this.button_play2=s;var n=new CustomButton(game_data.scene,0,320,this.handler_cancel,"common1","btn_red","btn_red","btn_red",this,null,null,.9);this.add(n),a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"level_failed",phrase_id:"3",values:[],base_size:45}),(t=new Phaser.GameObjects.Text(this.scene,0,-2,a.text,_objectSpread(_objectSpread({},game_data.styles.red_text),{},{fontFamily:"font1",fontSize:a.size,align:"center"}))).setOrigin(.5),n.add(t),this.button_play.y+=20,s.y+=20,n.y+=20;var o=new Phaser.GameObjects.Image(this.scene,this.continue_txt.x-25,this.button_play.y-3,"common1","rewarded_ad2");this.add(o),apples_ico=new Phaser.GameObjects.Image(this.scene,this.continue_txt2.x+-this.continue_txt2.displayWidth/2-35,s.y-3,"common1","money_ico"),this.add(apples_ico),this.timer={val:10},this.timer_txt=new Phaser.GameObjects.Text(this.scene,0,65,this.timer.val,{fontFamily:"font2",fontSize:50,color:"#a86233",stroke:"#ffe1a1",strokeThickness:3}),this.timer_txt.setOrigin(.5),this.add(this.timer_txt),this.countdown_tween=game_data.scene.tweens.add({targets:this.timer,val:0,duration:1e3*this.timer.val,onComplete:function(){i.handler_cancel()},onUpdate:function(){i.timer_txt.setText(Math.ceil(i.timer.val))}}),(this.currentStageAdsWatched>=game_data.allowed_ads||!allow_rewarded_ads)&&(this.button_play.setVisible(!1),o.setVisible(!1),n.y=this.button_play2.y,this.button_play2.y=this.button_play.y,s.y+=50,n.y+=50,this.title.y+=20,this.timer_txt.y+=20,apples_ico.y=this.button_play2.y-3,n.setScale(1)),this.each((function(e){return e.y-=100}))},handler_replay:function(){var e=this;this.countdown_tween&&this.countdown_tween.pause(),game_data.utils.show_rewarded_ad((function(t){if(t.success)e.countdown_tween&&(e.countdown_tween.pause(),e.countdown_tween.remove()),e.handler_continue();else{e.countdown_tween&&e.countdown_tween.resume();var a=game_data.utils.toGlobal(e.button_play,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:a,scene_id:"game_tip",item_id:"shop",phrase_id:"2",forced:!0,values:[]})}}))},handler_replay2:function(){var e=this;game_request.request({buy_level_continue:!0},(function(t){if("success"in t&&t.success){e.countdown_tween&&(e.countdown_tween.pause(),e.countdown_tween.remove());var a=game_data.game_map.get_money_pt(),i=game_data.utils.toGlobal(e.button_play2,new Phaser.Geom.Point(0,0));game_data.utils.fly_items({amount:5,holder:game_data.moving_holder,item_atlas:"common1",item_name:"money_ico",pt_start:a,pt_end:i},(function(){game_data.audio_manager.sound_event({play:!0,sound_name:"add_star"}),e.emitter.emit("EVENT",{event:"update_money"}),e.emitter.emit("EVENT",{event:"continue_game_pay"}),e.emitter.emit("EVENT",{event:"continue_game"}),e.handler_close()}))}else if(game_data.allow_exchange)game_data.utils.handler_exchange();else{var s=game_data.utils.toGlobal(e.button_play2,new Phaser.Geom.Point(0,0));game_data.utils.show_tip({pt:s,scene_id:"game_tip",item_id:"shop",phrase_id:"1",forced:!0,values:[]})}}))},handler_continue:function(){this.emitter.emit("EVENT",{event:"rewarded_ad_watched"}),this.emitter.emit("EVENT",{event:"continue_game"}),this.handler_close()},handler_cancel:function(){var e=this;game_request.request({level_failed:!0},(function(t){game_data.utils.check_ads("level_lost"),e.emitter.emit("EVENT",{event:"destroy_level"}),e.emitter.emit("EVENT",{event:"show_scene",scene_id:"MAP",failed:!0}),game_data.utils.game_play_stop(),e.handler_close()}))},pause_timer:function(){this.countdown_tween&&this.countdown_tween.pause()},resume_timer:function(){this.countdown_tween&&this.countdown_tween.resume()},handler_close:function(e){this.closed||(this.closed=!0,this.close_window(),this.countdown_tween&&(this.countdown_tween.pause(),this.countdown_tween.remove()))},close_window:function(){game_data.utils.hide_tip(),this.emitter.emit("EVENT",{event:"window_close"})}}),Options=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){if("GAME_PLAY"===game_data.current_scene&&(e.with_exit=!0),this.buttons=[],this.button_music=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.button_music),this.button_music_on=new CustomButton(this.scene,0,0,this.handler_music,"common1","btn_music_on","btn_music_on","btn_music_on",this),this.button_music.add(this.button_music_on),this.button_music_off=new CustomButton(this.scene,0,0,this.handler_music,"common1","btn_music_off","btn_music_off","btn_music_off",this),this.button_music.add(this.button_music_off),this.buttons.push(this.button_music),this.button_sound=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.button_sound),this.button_sound_on=new CustomButton(this.scene,0,0,this.handler_sound,"common1","btn_sound_on","btn_sound_on","btn_sound_on",this),this.button_sound.add(this.button_sound_on),this.button_sound_off=new CustomButton(this.scene,0,0,this.handler_sound,"common1","btn_sound_off","btn_sound_off","btn_sound_off",this),this.button_sound.add(this.button_sound_off),this.buttons.push(this.button_sound),this.button_language=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.button_language),this.update_button_language(),this.buttons.push(this.button_language),e.with_exit){this.button_home=new Phaser.GameObjects.Container(this.scene,0,0),this.add(this.button_home);var t=new CustomButton(this.scene,0,0,this.handler_home,"common1","btn_home_back","btn_home_back","btn_home_back",this);this.button_home.add(t),this.buttons.push(this.button_home)}for(var a=this.buttons.length,i=0;i<a;i++)this.buttons[i].x=200*(i-(a-1)/2),this.buttons[i].y=0;this.update_buttons()},handler_home:function(){this.emitter.emit("EVENT",{events:[{event:"window_close"},{event:"show_window",window_id:"quit"}]})},update_button_language:function(){game_data.user_data.lang.toLowerCase();this.button_language.removeAll(!0);var e=new CustomButton(this.scene,0,0,this.handler_language,"common1","btn_lang","btn_lang","btn_lang",this);this.button_language.add(e)},handler_language:function(e){this.emitter.emit("EVENT",{events:[{event:"window_close"},{event:"show_window",window_id:"select_language"}]})},update_buttons:function(){this.button_music_on.visible=1==game_data.user_data.music,this.button_music_off.visible=0==game_data.user_data.music,this.button_sound_on.visible=1==game_data.user_data.sound,this.button_sound_off.visible=0==game_data.user_data.sound;for(var e=this.buttons.length,t=0;t<e;t++)this.buttons[t].x=200*(t-(e-1)/2),this.buttons[t].y=0},handler_music:function(e){game_data.user_data.music=1-game_data.user_data.music,this.update_buttons(),game_request.request({set_options:!0,sound:game_data.user_data.sound,music:game_data.user_data.music},(function(){})),game_data.audio_manager.update_volume()},handler_sound:function(e){game_data.user_data.sound=1-game_data.user_data.sound,this.update_buttons(),game_request.request({set_options:!0,sound:game_data.user_data.sound,music:game_data.user_data.music},(function(){})),game_data.audio_manager.update_volume()},handler_replay:function(){},handler_close:function(e){this.close_window()},close_window:function(){this.emitter.emit("EVENT",{event:"window_close"})}}),PurchaseFailed=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){game_data.graphics_manager.get_window("info",null,[{handler:this.handler_close,type:"big"}],this,{scene_id:"game_windows",item_id:"purchase_failed",phrase_id:"1",values:[]},!0),this.button_play=this.buttons[0],this.title.y+=30,res=game_data.utils.generate_string({scene_id:"game_windows",item_id:"purchase_failed",phrase_id:"3",values:[],base_size:55});var t=new Phaser.GameObjects.Text(this.scene,0,-3,res.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:res.size}));t.setOrigin(.5),this.button_play.add(t);var a=new Phaser.GameObjects.Image(this.scene,0,-10,"common1","btn_fail");this.add(a),this.button_play.y-=30},handler_close:function(e){this.close_window()},close_window:function(e){this.emitter.emit("EVENT",{event:"window_close"})}}),PurchaseSuccess=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){game_data.graphics_manager.get_window("info",null,[{handler:this.handler_close,type:"big"}],this,{scene_id:"game_windows",item_id:"purchase_complete",phrase_id:"1",values:[]},!0),this.button_play=this.buttons[0],this.title.y+=30,res=game_data.utils.generate_string({scene_id:"game_windows",item_id:"purchase_complete",phrase_id:"3",values:[],base_size:55});var t=new Phaser.GameObjects.Text(this.scene,0,-3,res.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:res.size}));t.setOrigin(.5),this.button_play.add(t);var a=new Phaser.GameObjects.Image(this.scene,0,-10,"common1","btn_comp");this.add(a),this.button_play.y-=30},handler_close:function(e){this.close_window()},close_window:function(e){this.emitter.emit("EVENT",{event:"window_close"})}}),Quit=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){var t,a;this.paid_replay=!1,this.level_id=e.level_id,this.duel=e.duel,this.money_pt=e.money_pt,this.score=e.score,this.currentStageAdsWatched=e.currentStageAdsWatched,this.currentStage=e.currentStage,t={scene_id:"game_windows",item_id:"quit",phrase_id:"1",values:[]},game_data.graphics_manager.get_window("info",this.handler_close,[{handler:this.handler_no}],this,t,!0),this.button_play=this.buttons[0],this.button_play.y=60,this.button_close.setVisible(!1);var i=new Phaser.GameObjects.Image(this.scene,0,-65,"common1","question");i.scale=.75,this.add(i),this.question_ico=i,a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"quit",phrase_id:"3",values:[],base_size:45}),(t=new Phaser.GameObjects.Text(this.scene,0,0,a.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:a.size,align:"center"}))).setOrigin(.5),this.button_play.add(t),this.button_play.scale=.9,this.button_left=new CustomButton(game_data.scene,0,140,this.handler_yes,"common1","btn_red","btn_red","btn_red",this,null,null,1),a=game_data.utils.generate_string({scene_id:"game_windows",item_id:"quit",phrase_id:"2",values:[],base_size:45}),(t=new Phaser.GameObjects.Text(this.scene,0,0,a.text,_objectSpread(_objectSpread({},game_data.styles.light_text),{},{fontFamily:"font1",fontSize:a.size,align:"center",stroke:"#e83258"}))).setOrigin(.5),this.button_left.add(t),this.add(this.button_left),this.button_left.scale=.8,this.each((function(e){return e.y+=40}))},handler_no:function(){this.close_window()},handler_yes:function(){this.emitter.emit("EVENT",{event:"level_quit"}),this.close_window()},handler_close:function(e){this.closed||(this.closed=!0,this.close_window())},close_window:function(){game_data.utils.hide_tip(),this.emitter.emit("EVENT",{event:"window_close"})}}),SelectLanguage=new Phaser.Class({Extends:Phaser.GameObjects.Container,initialize:function(){this.scene=game_data.scene,Phaser.GameObjects.Container.call(this,this.scene,0,0),this.emitter=new Phaser.Events.EventEmitter},init:function(e){this.create_assets()},create_assets:function(){var e,t,a,i=this,s=game_data.langs;this.buttons_lang=[];for(var n=function(n){e=new Phaser.GameObjects.Container(i.scene,-(s.length-1)/2*150+150*n,0),i.add(e),(t=new Phaser.GameObjects.Image(i.scene,0,0,"common1","lang_"+s[n])).setOrigin(.5,.5),e.add(t),a=new CustomButton(i.scene,0,0,(function(){i.handler_language_click(s[n])}),"common1","lang_"+s[n],"lang_"+s[n],"lang_"+s[n],i),e.add(a),a.scale=.65,i.buttons_lang.push({lang:s[n].toUpperCase(),button_on:t,button_off:a})},o=0;o<s.length;o++)n(o);this.update_buttons(),this.update_language()},update_buttons:function(){var e,t=game_data.user_data.lang.toUpperCase();for(e=0;e<this.buttons_lang.length;e++)this.buttons_lang[e].button_on.visible=t==this.buttons_lang[e].lang,this.buttons_lang[e].button_off.visible=!(t==this.buttons_lang[e].lang)},update_language:function(){},handler_language_click:function(e){var t,a;for(t=0;t<this.buttons_lang.length;t++)e.toUpperCase()==this.buttons_lang[t].lang&&(a=this.buttons_lang[t].lang,game_data.user_data.lang=a.toLowerCase(),this.update_buttons(),this.update_language(),this.emitter.emit("EVENT",{event:"update_language"}),game_request.request({select_language:!0,lang:a.toLowerCase()},(function(e){})),this.handler_close())},handler_close:function(e){this.close_window()},close_window:function(e){this.emitter.emit("EVENT",{event:"window_close"})}});